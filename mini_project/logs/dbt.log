[0m19:22:07.961586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020014A87710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020014A847A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020014A85F70>]}


============================== 19:22:07.961586 | 25845aa5-0573-4ab4-b5f9-c1b1f3537209 ==============================
[0m19:22:07.961586 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:22:07.961586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:22:08.057074 [info ] [MainThread]: dbt version: 1.9.2
[0m19:22:08.057074 [info ] [MainThread]: python version: 3.12.9
[0m19:22:08.057074 [info ] [MainThread]: python path: C:\Users\AdithyaKasturi\env\Scripts\python.exe
[0m19:22:08.057074 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m19:22:08.464111 [info ] [MainThread]: Using profiles dir at C:\Users\AdithyaKasturi\.dbt
[0m19:22:08.464111 [info ] [MainThread]: Using profiles.yml file at C:\Users\AdithyaKasturi\.dbt\profiles.yml
[0m19:22:08.464111 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\AdithyaKasturi\mini_project\dbt_project.yml
[0m19:22:08.472894 [info ] [MainThread]: adapter type: snowflake
[0m19:22:08.472894 [info ] [MainThread]: adapter version: 1.9.1
[0m19:22:08.602952 [info ] [MainThread]: Configuration:
[0m19:22:08.602952 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:22:08.602952 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:22:08.602952 [info ] [MainThread]: Required dependencies:
[0m19:22:08.602952 [debug] [MainThread]: Executing "git --help"
[0m19:22:09.112675 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:22:09.112675 [debug] [MainThread]: STDERR: "b''"
[0m19:22:09.112675 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:22:09.112675 [info ] [MainThread]: Connection:
[0m19:22:09.112675 [info ] [MainThread]:   account: VGFRGWO-RP37445
[0m19:22:09.112675 [info ] [MainThread]:   user: kasturiadithya
[0m19:22:09.112675 [info ] [MainThread]:   database: mini_project
[0m19:22:09.112675 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m19:22:09.112675 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m19:22:09.112675 [info ] [MainThread]:   schema: RAW
[0m19:22:09.112675 [info ] [MainThread]:   authenticator: None
[0m19:22:09.112675 [info ] [MainThread]:   oauth_client_id: None
[0m19:22:09.124427 [info ] [MainThread]:   query_tag: None
[0m19:22:09.125435 [info ] [MainThread]:   client_session_keep_alive: False
[0m19:22:09.126154 [info ] [MainThread]:   host: None
[0m19:22:09.127192 [info ] [MainThread]:   port: None
[0m19:22:09.128188 [info ] [MainThread]:   proxy_host: None
[0m19:22:09.129471 [info ] [MainThread]:   proxy_port: None
[0m19:22:09.129471 [info ] [MainThread]:   protocol: None
[0m19:22:09.131305 [info ] [MainThread]:   connect_retries: 1
[0m19:22:09.132321 [info ] [MainThread]:   connect_timeout: None
[0m19:22:09.133678 [info ] [MainThread]:   retry_on_database_errors: False
[0m19:22:09.134687 [info ] [MainThread]:   retry_all: False
[0m19:22:09.135144 [info ] [MainThread]:   insecure_mode: False
[0m19:22:09.135770 [info ] [MainThread]:   reuse_connections: True
[0m19:22:09.136778 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:22:10.082069 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m19:22:13.485886 [debug] [MainThread]: Using snowflake connection "debug"
[0m19:22:13.485886 [debug] [MainThread]: On debug: select 1 as id
[0m19:22:13.489225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:22:14.604835 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.124 seconds
[0m19:22:14.604835 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:22:14.604835 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:22:14.604835 [debug] [MainThread]: Command `dbt debug` succeeded at 19:22:14.604835 after 7.02 seconds
[0m19:22:14.604835 [debug] [MainThread]: Connection 'debug' was left open.
[0m19:22:14.604835 [debug] [MainThread]: On debug: Close
[0m19:22:14.726800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200155B7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020016313D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020015F3E960>]}
[0m19:22:14.727533 [debug] [MainThread]: Flushing usage events
[0m19:22:15.730809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:35.457542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA054C60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA02016CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA07D57F20>]}


============================== 19:23:35.457542 | 0c455410-4e53-49fd-9f1f-3ea2c27db8bd ==============================
[0m19:23:35.457542 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:23:35.457542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:35.631814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c455410-4e53-49fd-9f1f-3ea2c27db8bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA082B3440>]}
[0m19:23:35.657817 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:23:35.657817 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:23:35.657817 [debug] [MainThread]: Command `cli deps` succeeded at 19:23:35.657817 after 0.43 seconds
[0m19:23:35.657817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA054C60F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA07D57F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA07D57F50>]}
[0m19:23:35.657817 [debug] [MainThread]: Flushing usage events
[0m19:23:36.736032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:59.743201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431FD4C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431FD4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431FD4AA0>]}


============================== 09:20:59.749566 | 49b0d80d-7150-43f6-8f44-234398ceb4da ==============================
[0m09:20:59.749566 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:20:59.749566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:20:59.899582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b0d80d-7150-43f6-8f44-234398ceb4da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431B318E0>]}
[0m09:20:59.944750 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:20:59.945749 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:20:59.947749 [debug] [MainThread]: Command `cli deps` succeeded at 09:20:59.946785 after 0.43 seconds
[0m09:20:59.947749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431B318E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014431C6C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000144321C45C0>]}
[0m09:20:59.948750 [debug] [MainThread]: Flushing usage events
[0m09:21:01.500075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:55.136747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B642358B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B638E2630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B64234BF0>]}


============================== 09:30:55.152729 | c3f2a87c-89c1-4f3a-a648-07661483d96e ==============================
[0m09:30:55.152729 [info ] [MainThread]: Running with dbt=1.9.0
[0m09:30:55.152729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:56.982676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B642347A0>]}
[0m09:30:57.060724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B64080E00>]}
[0m09:30:57.060724 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:30:57.712218 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m09:30:57.831110 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:30:57.831110 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m09:30:57.831110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B662FC680>]}
[0m09:30:59.464212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B64EF16D0>]}
[0m09:30:59.555334 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m09:30:59.597761 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m09:30:59.658348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B664F5C10>]}
[0m09:30:59.659350 [info ] [MainThread]: Found 1 model, 3 sources, 474 macros
[0m09:30:59.659350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6651E510>]}
[0m09:30:59.663799 [info ] [MainThread]: 
[0m09:30:59.664428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:30:59.666854 [info ] [MainThread]: 
[0m09:30:59.667542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:30:59.669067 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m09:31:04.137844 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m09:31:04.139852 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m09:31:04.139852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:05.136430 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.010 seconds
[0m09:31:05.153144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_RAW'
[0m09:31:05.166901 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m09:31:05.166901 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m09:31:05.166901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:05.636927 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.470 seconds
[0m09:31:05.636927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B66477560>]}
[0m09:31:05.636927 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m09:31:05.636927 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.customers ...................................... [RUN]
[0m09:31:05.636927 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m09:31:05.636927 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m09:31:05.658559 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m09:31:05.661612 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m09:31:05.703640 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m09:31:05.706291 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m09:31:05.706291 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace   view mini_project.RAW.customers
  
   as (
    select
*
from
mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
  );
[0m09:31:05.708799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:31:06.301350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m09:31:06.340090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f2a87c-89c1-4f3a-a648-07661483d96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B637148C0>]}
[0m09:31:06.340090 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.customers ................................. [[32mSUCCESS 1[0m in 0.70s]
[0m09:31:06.340090 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m09:31:06.340090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:06.340090 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m09:31:06.340090 [debug] [MainThread]: On list_mini_project: Close
[0m09:31:06.464917 [debug] [MainThread]: Connection 'list_mini_project_RAW' was left open.
[0m09:31:06.464917 [debug] [MainThread]: On list_mini_project_RAW: Close
[0m09:31:06.579494 [debug] [MainThread]: Connection 'model.mini_project.customers' was left open.
[0m09:31:06.579494 [debug] [MainThread]: On model.mini_project.customers: Close
[0m09:31:06.671239 [info ] [MainThread]: 
[0m09:31:06.671239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m09:31:06.671239 [debug] [MainThread]: Command end result
[0m09:31:06.705603 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m09:31:06.709333 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m09:31:06.709333 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m09:31:06.709333 [info ] [MainThread]: 
[0m09:31:06.709333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:31:06.719504 [info ] [MainThread]: 
[0m09:31:06.719504 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:31:06.721287 [debug] [MainThread]: Command `cli run` succeeded at 09:31:06.721287 after 11.87 seconds
[0m09:31:06.721287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B63F18170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B6420FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B638E2630>]}
[0m09:31:06.721287 [debug] [MainThread]: Flushing usage events
[0m09:31:07.738935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:32.942261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A6374980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A6374D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A63746E0>]}


============================== 10:16:32.954574 | cabe57a2-fda8-4a09-92e8-844925a6cbdb ==============================
[0m10:16:32.954574 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:32.954574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:stg', 'send_anonymous_usage_stats': 'True'}
[0m10:16:34.523310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A373A8D0>]}
[0m10:16:34.603172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A6F34560>]}
[0m10:16:34.603172 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:16:35.268495 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:35.400635 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:16:35.400635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A840D760>]}
[0m10:16:38.036570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A70A2120>]}
[0m10:16:38.115402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:16:38.146813 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:16:38.241799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A83CE060>]}
[0m10:16:38.241799 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:16:38.241799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A70A1A60>]}
[0m10:16:38.241799 [info ] [MainThread]: 
[0m10:16:38.241799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:16:38.241799 [info ] [MainThread]: 
[0m10:16:38.241799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:16:38.260579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m10:16:40.341460 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m10:16:40.341460 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m10:16:40.341460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:41.495073 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.163 seconds
[0m10:16:41.509587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_staging)
[0m10:16:41.509587 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "staging"
"
[0m10:16:41.509587 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_staging"
[0m10:16:41.509587 [debug] [ThreadPool]: On create_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_mini_project_staging"} */
create schema if not exists mini_project.staging
[0m10:16:41.621221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.115 seconds
[0m10:16:41.638003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m10:16:41.651043 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m10:16:41.651661 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m10:16:41.651661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:42.042808 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.403 seconds
[0m10:16:42.042808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A8495FD0>]}
[0m10:16:42.074395 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m10:16:42.074395 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.customers ................................. [RUN]
[0m10:16:42.074395 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m10:16:42.074395 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m10:16:42.074395 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m10:16:42.074395 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m10:16:42.130692 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m10:16:42.132657 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m10:16:42.133692 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace transient table mini_project.staging.customers
         as
        (SELECT
DISTINCT * 
FROM mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
WHERE customer_id IS NOT NULL AND company IS NOT NULL AND customer_name IS NOT NULL
ORDER BY customer_id
        );
[0m10:16:42.133692 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:16:43.341579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.216 seconds
[0m10:16:43.373244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A37398B0>]}
[0m10:16:43.373244 [info ] [Thread-1 (]: 1 of 3 OK created sql table model staging.customers ............................ [[32mSUCCESS 1[0m in 1.30s]
[0m10:16:43.373244 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m10:16:43.373244 [debug] [Thread-1 (]: Began running node model.mini_project.products
[0m10:16:43.373244 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.products .................................. [RUN]
[0m10:16:43.373244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customers, now model.mini_project.products)
[0m10:16:43.373244 [debug] [Thread-1 (]: Began compiling node model.mini_project.products
[0m10:16:43.373244 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.products"
[0m10:16:43.387371 [debug] [Thread-1 (]: Began executing node model.mini_project.products
[0m10:16:43.390198 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.products"
[0m10:16:43.392576 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.products"
[0m10:16:43.393586 [debug] [Thread-1 (]: On model.mini_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.products"} */
create or replace transient table mini_project.staging.products
         as
        (SELECT
DISTINCT * 
FROM mini_project.raw.ONLINE_FOOD_DELIVERY_PRODUCTS
WHERE PRODUCT_ID IS NOT NULL AND PRODUCT_FAMILY IS NOT NULL AND PRODUCT_SUB_FAMILY IS NOT NULL
ORDER BY PRODUCT_ID
        );
[0m10:16:44.350088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.958 seconds
[0m10:16:44.350088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A8BDD190>]}
[0m10:16:44.350088 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.products ............................. [[32mSUCCESS 1[0m in 0.98s]
[0m10:16:44.350088 [debug] [Thread-1 (]: Finished running node model.mini_project.products
[0m10:16:44.350088 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m10:16:44.350088 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.transactions .............................. [RUN]
[0m10:16:44.350088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.products, now model.mini_project.transactions)
[0m10:16:44.350088 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m10:16:44.361661 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m10:16:44.363860 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m10:16:44.367654 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m10:16:44.368572 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m10:16:44.368572 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (SELECT
DISTINCT * 
FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
WHERE
CUSTOMER_ID IS NOT NULL AND 
PRODUCT_ID IS NOT NULL AND 
PAYMENT_MONTH IS NOT NULL AND 
REVENUE_TYPE IS NOT NULL AND 
REVENUE IS NOT NULL AND 
QUANTITY IS NOT NULL AND
DIMENSION_1 IS NOT NULL AND
DIMENSION_2 IS NOT NULL AND
DIMENSION_3 IS NOT NULL AND
DIMENSION_4 IS NOT NULL AND
DIMENSION_5 IS NOT NULL AND
DIMENSION_6 IS NOT NULL AND
DIMENSION_7 IS NOT NULL AND
DIMENSION_8 IS NOT NULL AND
DIMENSION_9 IS NOT NULL AND
DIMENSION_10 IS NOT NULL AND
COMPANIES IS NOT NULL
ORDER BY PAYMENT_MONTH
        );
[0m10:16:45.325123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.966 seconds
[0m10:16:45.325123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cabe57a2-fda8-4a09-92e8-844925a6cbdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A8C22D50>]}
[0m10:16:45.341683 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.transactions ......................... [[32mSUCCESS 1[0m in 0.98s]
[0m10:16:45.342171 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m10:16:45.342171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:45.342171 [debug] [MainThread]: Connection 'create_mini_project_staging' was left open.
[0m10:16:45.342171 [debug] [MainThread]: On create_mini_project_staging: Close
[0m10:16:45.527017 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m10:16:45.527017 [debug] [MainThread]: On list_mini_project_staging: Close
[0m10:16:45.622105 [debug] [MainThread]: Connection 'model.mini_project.transactions' was left open.
[0m10:16:45.622105 [debug] [MainThread]: On model.mini_project.transactions: Close
[0m10:16:45.732814 [info ] [MainThread]: 
[0m10:16:45.732814 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m10:16:45.748943 [debug] [MainThread]: Command end result
[0m10:16:45.777609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:16:45.783323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:16:45.788275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m10:16:45.788275 [info ] [MainThread]: 
[0m10:16:45.788275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:45.788275 [info ] [MainThread]: 
[0m10:16:45.788275 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:16:45.788275 [debug] [MainThread]: Command `dbt run` succeeded at 10:16:45.788275 after 13.08 seconds
[0m10:16:45.788275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A394DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A6327A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8A6D30620>]}
[0m10:16:45.788275 [debug] [MainThread]: Flushing usage events
[0m10:16:46.798149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:55.448312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E07AA330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156DFEA79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E34D43E0>]}


============================== 10:47:55.452121 | 0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9 ==============================
[0m10:47:55.452121 [info ] [MainThread]: Running with dbt=1.9.0
[0m10:47:55.452121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:47:55.981106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E528A840>]}
[0m10:47:56.060520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E35183E0>]}
[0m10:47:56.060520 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:47:56.648362 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m10:47:56.753176 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m10:47:56.753176 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m10:47:56.753176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E425EE70>]}
[0m10:47:58.380170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E57102F0>]}
[0m10:47:58.455217 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:47:58.490182 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:47:58.523057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5707740>]}
[0m10:47:58.523057 [info ] [MainThread]: Found 3 models, 3 sources, 475 macros
[0m10:47:58.532486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5690920>]}
[0m10:47:58.536657 [info ] [MainThread]: 
[0m10:47:58.536657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:58.537621 [info ] [MainThread]: 
[0m10:47:58.537621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:58.539082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m10:47:58.657036 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m10:47:58.657036 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m10:47:58.657036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:59.558645 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.902 seconds
[0m10:47:59.574144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m10:47:59.591236 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m10:47:59.591236 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m10:47:59.591236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:59.981269 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.395 seconds
[0m10:47:59.981269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E366C260>]}
[0m10:47:59.998075 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m10:47:59.998075 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.transactions .............................. [RUN]
[0m10:48:00.010542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.transactions'
[0m10:48:00.010542 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m10:48:00.021159 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m10:48:00.029439 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m10:48:00.068112 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m10:48:00.068112 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m10:48:00.068112 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
    WHERE
    CUSTOMER_ID IS NOT NULL AND 
    PRODUCT_ID IS NOT NULL AND 
    PAYMENT_MONTH IS NOT NULL AND 
    REVENUE_TYPE IS NOT NULL AND 
    REVENUE IS NOT NULL AND 
    QUANTITY IS NOT NULL AND
    DIMENSION_1 IS NOT NULL AND
    DIMENSION_2 IS NOT NULL AND
    DIMENSION_3 IS NOT NULL AND
    DIMENSION_4 IS NOT NULL AND
    DIMENSION_5 IS NOT NULL AND
    DIMENSION_6 IS NOT NULL AND
    DIMENSION_7 IS NOT NULL AND
    DIMENSION_8 IS NOT NULL AND
    DIMENSION_9 IS NOT NULL AND
    DIMENSION_10 IS NOT NULL AND
    COMPANIES IS NOT NULL
    ORDER BY PAYMENT_MONTH
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
PRODUCT_ID,
CAST(PAYMENT_MONTH AS DATE) AS PAYMENT_MONTH,
CAST(REVENUE_TYPE AS SMALLINT) AS REVENUE_TYPE,
CAST(REVENUE AS FLOAT) AS REVENUE,
CAST(QUANTITY AS SMALLINT) AS QUANTITY,
COMPANIES
FROM RAW_FORM
        );
[0m10:48:00.068112 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:01.504947 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedd-3201-7d7b-000c-3d6e0002431a
[0m10:48:01.504947 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100040 (22007): Date '01-01-2018' is not recognized
[0m10:48:01.504947 [debug] [Thread-1 (]: Database Error in model transactions (models\staging\transactions.sql)
  100040 (22007): Date '01-01-2018' is not recognized
  compiled code at target\run\mini_project\models\staging\transactions.sql
[0m10:48:01.504947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c65bfb0-9fdf-491e-8ed1-8039ca5b5cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E29B4B30>]}
[0m10:48:01.504947 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.transactions ..................... [[31mERROR[0m in 1.50s]
[0m10:48:01.504947 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m10:48:01.504947 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.transactions' to be skipped because of status 'error'.  Reason: Database Error in model transactions (models\staging\transactions.sql)
  100040 (22007): Date '01-01-2018' is not recognized
  compiled code at target\run\mini_project\models\staging\transactions.sql.
[0m10:48:01.520875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:01.520875 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m10:48:01.520875 [debug] [MainThread]: On list_mini_project: Close
[0m10:48:01.627065 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m10:48:01.627065 [debug] [MainThread]: On list_mini_project_staging: Close
[0m10:48:01.738776 [debug] [MainThread]: Connection 'model.mini_project.transactions' was left open.
[0m10:48:01.738776 [debug] [MainThread]: On model.mini_project.transactions: Close
[0m10:48:01.857291 [info ] [MainThread]: 
[0m10:48:01.859976 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m10:48:01.859976 [debug] [MainThread]: Command end result
[0m10:48:01.889809 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:48:01.893478 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:48:01.893882 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m10:48:01.893882 [info ] [MainThread]: 
[0m10:48:01.893882 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:48:01.893882 [info ] [MainThread]: 
[0m10:48:01.903637 [error] [MainThread]:   Database Error in model transactions (models\staging\transactions.sql)
  100040 (22007): Date '01-01-2018' is not recognized
  compiled code at target\run\mini_project\models\staging\transactions.sql
[0m10:48:01.904080 [info ] [MainThread]: 
[0m10:48:01.904695 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:48:01.906854 [debug] [MainThread]: Command `cli run` failed at 10:48:01.906854 after 6.69 seconds
[0m10:48:01.906854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E34D4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E34D5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E34D43E0>]}
[0m10:48:01.909593 [debug] [MainThread]: Flushing usage events
[0m10:48:03.289566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:24.065138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3E3A57F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4058FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4058FF50>]}


============================== 10:58:24.065138 | ae040d0d-573f-4158-a160-172000911275 ==============================
[0m10:58:24.065138 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:58:24.065138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:stg', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:25.509392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3E49A8A0>]}
[0m10:58:25.588194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F413B0590>]}
[0m10:58:25.588194 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:58:26.175917 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:58:26.289740 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:58:26.289740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4313D700>]}
[0m10:58:29.423485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F41EF7C20>]}
[0m10:58:29.492330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:58:29.527174 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:58:29.586793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4333DEB0>]}
[0m10:58:29.586793 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m10:58:29.586793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4332D850>]}
[0m10:58:29.586793 [info ] [MainThread]: 
[0m10:58:29.586793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:29.586793 [info ] [MainThread]: 
[0m10:58:29.586793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:58:29.602816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m10:58:33.523001 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m10:58:33.523001 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m10:58:33.523001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:34.393241 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.871 seconds
[0m10:58:34.393241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m10:58:34.410168 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m10:58:34.410168 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m10:58:34.410168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:34.832167 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.420 seconds
[0m10:58:34.838544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F43257380>]}
[0m10:58:34.840551 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m10:58:34.842560 [info ] [Thread-1 (]: 1 of 3 START sql table model staging.customers ................................. [RUN]
[0m10:58:34.842560 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m10:58:34.844567 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m10:58:34.851391 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m10:58:34.851391 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m10:58:34.887255 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m10:58:34.899325 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m10:58:34.899325 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace transient table mini_project.staging.customers
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
    WHERE customer_id IS NOT NULL AND company IS NOT NULL AND customer_name IS NOT NULL
    ORDER BY customer_id
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
CUSTOMER_NAME,
COMPANY
FROM RAW_FORM
        );
[0m10:58:34.899325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:35.703409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.813 seconds
[0m10:58:35.735575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4058CC80>]}
[0m10:58:35.735575 [info ] [Thread-1 (]: 1 of 3 OK created sql table model staging.customers ............................ [[32mSUCCESS 1[0m in 0.89s]
[0m10:58:35.735575 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m10:58:35.735575 [debug] [Thread-1 (]: Began running node model.mini_project.products
[0m10:58:35.735575 [info ] [Thread-1 (]: 2 of 3 START sql table model staging.products .................................. [RUN]
[0m10:58:35.735575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customers, now model.mini_project.products)
[0m10:58:35.735575 [debug] [Thread-1 (]: Began compiling node model.mini_project.products
[0m10:58:35.735575 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.products"
[0m10:58:35.735575 [debug] [Thread-1 (]: Began executing node model.mini_project.products
[0m10:58:35.752437 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.products"
[0m10:58:35.753481 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.products"
[0m10:58:35.754642 [debug] [Thread-1 (]: On model.mini_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.products"} */
create or replace transient table mini_project.staging.products
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_PRODUCTS
    WHERE PRODUCT_ID IS NOT NULL AND PRODUCT_FAMILY IS NOT NULL AND PRODUCT_SUB_FAMILY IS NOT NULL
    ORDER BY PRODUCT_ID
)
SELECT
*
FROM
RAW_FORM
        );
[0m10:58:36.223230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m10:58:36.223230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F4392CF80>]}
[0m10:58:36.223230 [info ] [Thread-1 (]: 2 of 3 OK created sql table model staging.products ............................. [[32mSUCCESS 1[0m in 0.49s]
[0m10:58:36.236145 [debug] [Thread-1 (]: Finished running node model.mini_project.products
[0m10:58:36.236145 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m10:58:36.236145 [info ] [Thread-1 (]: 3 of 3 START sql table model staging.transactions .............................. [RUN]
[0m10:58:36.238906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.products, now model.mini_project.transactions)
[0m10:58:36.238906 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m10:58:36.238906 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m10:58:36.238906 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m10:58:36.238906 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m10:58:36.238906 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m10:58:36.238906 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
    WHERE
    CUSTOMER_ID IS NOT NULL AND 
    PRODUCT_ID IS NOT NULL AND 
    PAYMENT_MONTH IS NOT NULL AND 
    REVENUE_TYPE IS NOT NULL AND 
    REVENUE IS NOT NULL AND 
    QUANTITY IS NOT NULL AND
    DIMENSION_1 IS NOT NULL AND
    DIMENSION_2 IS NOT NULL AND
    DIMENSION_3 IS NOT NULL AND
    DIMENSION_4 IS NOT NULL AND
    DIMENSION_5 IS NOT NULL AND
    DIMENSION_6 IS NOT NULL AND
    DIMENSION_7 IS NOT NULL AND
    DIMENSION_8 IS NOT NULL AND
    DIMENSION_9 IS NOT NULL AND
    DIMENSION_10 IS NOT NULL AND
    COMPANIES IS NOT NULL
    ORDER BY PAYMENT_MONTH
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
PRODUCT_ID,
TRY_TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
CAST(REVENUE_TYPE AS SMALLINT) AS REVENUE_TYPE,
CAST(REVENUE AS FLOAT) AS REVENUE,
CAST(QUANTITY AS SMALLINT) AS QUANTITY,
COMPANIES
FROM RAW_FORM
        );
[0m10:58:36.838635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m10:58:36.838635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae040d0d-573f-4158-a160-172000911275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F43A46030>]}
[0m10:58:36.838635 [info ] [Thread-1 (]: 3 of 3 OK created sql table model staging.transactions ......................... [[32mSUCCESS 1[0m in 0.60s]
[0m10:58:36.838635 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m10:58:36.838635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:36.838635 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m10:58:36.838635 [debug] [MainThread]: On list_mini_project: Close
[0m10:58:36.951961 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m10:58:36.951961 [debug] [MainThread]: On list_mini_project_staging: Close
[0m10:58:37.062895 [debug] [MainThread]: Connection 'model.mini_project.transactions' was left open.
[0m10:58:37.062895 [debug] [MainThread]: On model.mini_project.transactions: Close
[0m10:58:37.175023 [info ] [MainThread]: 
[0m10:58:37.175023 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m10:58:37.175023 [debug] [MainThread]: Command end result
[0m10:58:37.224326 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m10:58:37.236234 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m10:58:37.244972 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m10:58:37.244972 [info ] [MainThread]: 
[0m10:58:37.244972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:58:37.244972 [info ] [MainThread]: 
[0m10:58:37.244972 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:58:37.244972 [debug] [MainThread]: Command `dbt run` succeeded at 10:58:37.244972 after 13.46 seconds
[0m10:58:37.251907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3EE82690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F3EE823C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F432F18B0>]}
[0m10:58:37.251907 [debug] [MainThread]: Flushing usage events
[0m10:58:38.259805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:27.244052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D2A41850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D563FD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D5D4D280>]}


============================== 11:51:27.266748 | 2c602f13-bec3-40b2-ba22-ba4c7cb412cd ==============================
[0m11:51:27.266748 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:51:27.266748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:joins', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:28.687348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D69BC230>]}
[0m11:51:28.768990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D68F1A00>]}
[0m11:51:28.768990 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:51:29.383399 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:51:29.487947 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:51:29.488970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D6C6F050>]}
[0m11:51:31.682204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D81C0560>]}
[0m11:51:31.772015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m11:51:31.793063 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m11:51:31.872063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D82492B0>]}
[0m11:51:31.872063 [info ] [MainThread]: Found 4 models, 3 sources, 473 macros
[0m11:51:31.872063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D80D3A10>]}
[0m11:51:31.872063 [info ] [MainThread]: 
[0m11:51:31.872063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:31.872063 [info ] [MainThread]: 
[0m11:51:31.872063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:31.883443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m11:51:33.240588 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m11:51:33.240588 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m11:51:33.240588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:34.058785 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.826 seconds
[0m11:51:34.058785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_intermediate_joins)
[0m11:51:34.058785 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "intermediate_joins"
"
[0m11:51:34.076698 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_intermediate_joins"
[0m11:51:34.076698 [debug] [ThreadPool]: On create_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_mini_project_intermediate_joins"} */
create schema if not exists mini_project.intermediate_joins
[0m11:51:34.188091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.110 seconds
[0m11:51:34.203939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m11:51:34.203939 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m11:51:34.203939 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m11:51:34.219657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:34.642942 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.433 seconds
[0m11:51:34.642942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m11:51:34.658861 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m11:51:34.658861 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m11:51:34.755483 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.105 seconds
[0m11:51:34.755483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D86EAEA0>]}
[0m11:51:34.773364 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m11:51:34.774365 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate_joins.join ........................... [RUN]
[0m11:51:34.775445 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.join'
[0m11:51:34.776505 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m11:51:34.788084 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m11:51:34.790521 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m11:51:34.823185 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m11:51:34.823185 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m11:51:34.836467 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') as PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
order by customer_id
        );
[0m11:51:34.836467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:36.229969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.406 seconds
[0m11:51:36.266363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c602f13-bec3-40b2-ba22-ba4c7cb412cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D547C530>]}
[0m11:51:36.266363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate_joins.join ...................... [[32mSUCCESS 1[0m in 1.49s]
[0m11:51:36.266363 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m11:51:36.266363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:36.266363 [debug] [MainThread]: Connection 'create_mini_project_intermediate_joins' was left open.
[0m11:51:36.266363 [debug] [MainThread]: On create_mini_project_intermediate_joins: Close
[0m11:51:36.387767 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m11:51:36.388764 [debug] [MainThread]: On list_mini_project_staging: Close
[0m11:51:36.487305 [debug] [MainThread]: Connection 'model.mini_project.join' was left open.
[0m11:51:36.487305 [debug] [MainThread]: On model.mini_project.join: Close
[0m11:51:36.607416 [info ] [MainThread]: 
[0m11:51:36.607416 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m11:51:36.611520 [debug] [MainThread]: Command end result
[0m11:51:36.641710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m11:51:36.641710 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m11:51:36.658510 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m11:51:36.658510 [info ] [MainThread]: 
[0m11:51:36.658510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:36.658510 [info ] [MainThread]: 
[0m11:51:36.658510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:36.658510 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:36.658510 after 9.63 seconds
[0m11:51:36.658510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D5AC8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D5AC85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000130D563FD40>]}
[0m11:51:36.666638 [debug] [MainThread]: Flushing usage events
[0m11:51:37.720340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:25.493517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDF35970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEBDC7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDBB3FE0>]}


============================== 13:52:25.493517 | c704f78d-3b0c-416f-83bd-91a4022a517d ==============================
[0m13:52:25.493517 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:52:25.493517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:joins', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:26.961072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFCEEA50>]}
[0m13:52:27.044030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEB671580>]}
[0m13:52:27.046038 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:52:27.686204 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:52:27.779909 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:52:27.790948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDA7B1A0>]}
[0m13:52:30.347140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDC4E420>]}
[0m13:52:30.451562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m13:52:30.482262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m13:52:30.574972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DF00D9DF0>]}
[0m13:52:30.574972 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m13:52:30.577140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DF001EC90>]}
[0m13:52:30.578282 [info ] [MainThread]: 
[0m13:52:30.578282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:30.578282 [info ] [MainThread]: 
[0m13:52:30.582949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:30.587957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m13:52:32.370682 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m13:52:32.370682 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m13:52:32.370682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:33.224509 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.847 seconds
[0m13:52:33.232101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_RAW'
[0m13:52:33.247219 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m13:52:33.247219 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m13:52:33.248329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:33.703736 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.456 seconds
[0m13:52:33.706726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_staging)
[0m13:52:33.710729 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m13:52:33.711726 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m13:52:33.851359 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.140 seconds
[0m13:52:33.855359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m13:52:33.861154 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m13:52:33.861154 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m13:52:33.966896 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m13:52:33.972549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEFD16D80>]}
[0m13:52:33.979482 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m13:52:33.980785 [info ] [Thread-1 (]: 1 of 3 START sql table model intermediate_joins.join ........................... [RUN]
[0m13:52:33.981943 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.join'
[0m13:52:33.983119 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m13:52:33.995128 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m13:52:33.997128 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m13:52:34.040535 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m13:52:34.044550 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m13:52:34.044550 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
order by customer_id
where REVENUE_TYPE=1
        );
[0m13:52:34.044550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:52:34.654274 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff96-3201-7e9a-000c-3d6e0002524e
[0m13:52:34.654274 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 0 unexpected 'where'.
[0m13:52:34.667439 [debug] [Thread-1 (]: Database Error in model join (models\intermediate_joins\join.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 0 unexpected 'where'.
  compiled code at target\run\mini_project\models\intermediate_joins\join.sql
[0m13:52:34.670446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c704f78d-3b0c-416f-83bd-91a4022a517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DF0655B50>]}
[0m13:52:34.671251 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model intermediate_joins.join .................. [[31mERROR[0m in 0.69s]
[0m13:52:34.671251 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m13:52:34.671251 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.join' to be skipped because of status 'error'.  Reason: Database Error in model join (models\intermediate_joins\join.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 0 unexpected 'where'.
  compiled code at target\run\mini_project\models\intermediate_joins\join.sql.
[0m13:52:34.671251 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m13:52:34.671251 [info ] [Thread-1 (]: 2 of 3 SKIP relation intermediate_joins.month_revenue .......................... [[33mSKIP[0m]
[0m13:52:34.671251 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m13:52:34.677760 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m13:52:34.677760 [info ] [Thread-1 (]: 3 of 3 SKIP relation intermediate_joins.outer_join ............................. [[33mSKIP[0m]
[0m13:52:34.678806 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m13:52:34.680804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:34.680804 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m13:52:34.681797 [debug] [MainThread]: On list_mini_project: Close
[0m13:52:34.815548 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m13:52:34.816580 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m13:52:34.940075 [debug] [MainThread]: Connection 'model.mini_project.join' was left open.
[0m13:52:34.941074 [debug] [MainThread]: On model.mini_project.join: Close
[0m13:52:35.043639 [info ] [MainThread]: 
[0m13:52:35.044607 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m13:52:35.045600 [debug] [MainThread]: Command end result
[0m13:52:35.075339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m13:52:35.079333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m13:52:35.088165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m13:52:35.088165 [info ] [MainThread]: 
[0m13:52:35.090174 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:52:35.092183 [info ] [MainThread]: 
[0m13:52:35.092183 [error] [MainThread]:   Database Error in model join (models\intermediate_joins\join.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 0 unexpected 'where'.
  compiled code at target\run\mini_project\models\intermediate_joins\join.sql
[0m13:52:35.092183 [info ] [MainThread]: 
[0m13:52:35.094195 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m13:52:35.094195 [debug] [MainThread]: Command `dbt run` failed at 13:52:35.094195 after 9.82 seconds
[0m13:52:35.094195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DED82A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEEB30230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DEDEE7740>]}
[0m13:52:35.094195 [debug] [MainThread]: Flushing usage events
[0m13:52:36.656955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:03.366472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113C981D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CA4E0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CCD202C0>]}


============================== 13:53:03.378216 | 41289478-ff84-4b1b-a0dc-5bdbe1ce6528 ==============================
[0m13:53:03.378216 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:53:03.378216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:joins', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:03.967093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CD231E80>]}
[0m13:53:04.058746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CDE9CB90>]}
[0m13:53:04.061286 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m13:53:04.507575 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:53:04.608608 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:53:04.608608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CCD5B2C0>]}
[0m13:53:06.146974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CF0173B0>]}
[0m13:53:06.227502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m13:53:06.235237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m13:53:06.273269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CF28E660>]}
[0m13:53:06.273269 [info ] [MainThread]: Found 7 models, 3 sources, 474 macros
[0m13:53:06.273269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CF3BEB70>]}
[0m13:53:06.277706 [info ] [MainThread]: 
[0m13:53:06.277706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:06.277706 [info ] [MainThread]: 
[0m13:53:06.277706 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:06.287327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m13:53:06.410902 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m13:53:06.414501 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m13:53:06.414501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:07.341466 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.931 seconds
[0m13:53:07.341466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_RAW'
[0m13:53:07.357166 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m13:53:07.357166 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m13:53:07.357166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:07.768592 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.408 seconds
[0m13:53:07.768592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_staging)
[0m13:53:07.768592 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m13:53:07.778371 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m13:53:07.857808 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.081 seconds
[0m13:53:07.857808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m13:53:07.857808 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m13:53:07.857808 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m13:53:07.954594 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m13:53:07.954594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CF9452B0>]}
[0m13:53:07.954594 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m13:53:07.954594 [info ] [Thread-1 (]: 1 of 3 START sql table model intermediate_joins.join ........................... [RUN]
[0m13:53:07.954594 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.join'
[0m13:53:07.954594 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m13:53:07.976687 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m13:53:07.979031 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m13:53:08.018696 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m13:53:08.021697 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m13:53:08.021697 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
where REVENUE_TYPE=1
order by customer_id
        );
[0m13:53:08.022697 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:09.236996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.229 seconds
[0m13:53:09.284462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CA5C9BB0>]}
[0m13:53:09.284462 [info ] [Thread-1 (]: 1 of 3 OK created sql table model intermediate_joins.join ...................... [[32mSUCCESS 1[0m in 1.33s]
[0m13:53:09.284462 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m13:53:09.284462 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m13:53:09.284462 [info ] [Thread-1 (]: 2 of 3 START sql table model intermediate_joins.month_revenue .................. [RUN]
[0m13:53:09.284462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.join, now model.mini_project.month_revenue)
[0m13:53:09.284462 [debug] [Thread-1 (]: Began compiling node model.mini_project.month_revenue
[0m13:53:09.284462 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.month_revenue"
[0m13:53:09.284462 [debug] [Thread-1 (]: Began executing node model.mini_project.month_revenue
[0m13:53:09.302319 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.month_revenue"
[0m13:53:09.304056 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.month_revenue"
[0m13:53:09.305110 [debug] [Thread-1 (]: On model.mini_project.month_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.month_revenue"} */
create or replace transient table mini_project.intermediate_joins.month_revenue
         as
        (SELECT 
    customer_id,
    product_id,
    payment_month,
    SUM(revenue) AS total_revenue
FROM 
    mini_project.intermediate_joins.join
GROUP BY 
    customer_id, 
    product_id,
    payment_month
ORDER BY 
    customer_id, 
    product_id, 
    payment_month
        );
[0m13:53:10.049435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m13:53:10.055510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CFB711F0>]}
[0m13:53:10.057535 [info ] [Thread-1 (]: 2 of 3 OK created sql table model intermediate_joins.month_revenue ............. [[32mSUCCESS 1[0m in 0.77s]
[0m13:53:10.062957 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m13:53:10.062957 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m13:53:10.062957 [info ] [Thread-1 (]: 3 of 3 START sql table model intermediate_joins.outer_join ..................... [RUN]
[0m13:53:10.062957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.month_revenue, now model.mini_project.outer_join)
[0m13:53:10.072329 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m13:53:10.078390 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m13:53:10.080354 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m13:53:10.084989 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m13:53:10.087932 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m13:53:10.087932 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id and j.total_revenue=mr.total_revenue
        );
[0m13:53:10.166829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff97-3201-7d7b-000c-3d6e00024612
[0m13:53:10.166829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 67
invalid identifier 'J.TOTAL_REVENUE'
[0m13:53:10.182880 [debug] [Thread-1 (]: Database Error in model outer_join (models\intermediate_joins\outer_join.sql)
  000904 (42000): SQL compilation error: error line 20 at position 67
  invalid identifier 'J.TOTAL_REVENUE'
  compiled code at target\run\mini_project\models\intermediate_joins\outer_join.sql
[0m13:53:10.182880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41289478-ff84-4b1b-a0dc-5bdbe1ce6528', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CDF21EB0>]}
[0m13:53:10.182880 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model intermediate_joins.outer_join ............ [[31mERROR[0m in 0.12s]
[0m13:53:10.182880 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m13:53:10.182880 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.outer_join' to be skipped because of status 'error'.  Reason: Database Error in model outer_join (models\intermediate_joins\outer_join.sql)
  000904 (42000): SQL compilation error: error line 20 at position 67
  invalid identifier 'J.TOTAL_REVENUE'
  compiled code at target\run\mini_project\models\intermediate_joins\outer_join.sql.
[0m13:53:10.182880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:10.182880 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m13:53:10.182880 [debug] [MainThread]: On list_mini_project: Close
[0m13:53:10.299260 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m13:53:10.299260 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m13:53:10.400450 [debug] [MainThread]: Connection 'model.mini_project.outer_join' was left open.
[0m13:53:10.400450 [debug] [MainThread]: On model.mini_project.outer_join: Close
[0m13:53:10.512436 [info ] [MainThread]: 
[0m13:53:10.528347 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m13:53:10.528347 [debug] [MainThread]: Command end result
[0m13:53:10.558402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m13:53:10.558402 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m13:53:10.569837 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m13:53:10.569837 [info ] [MainThread]: 
[0m13:53:10.569837 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:10.569837 [info ] [MainThread]: 
[0m13:53:10.569837 [error] [MainThread]:   Database Error in model outer_join (models\intermediate_joins\outer_join.sql)
  000904 (42000): SQL compilation error: error line 20 at position 67
  invalid identifier 'J.TOTAL_REVENUE'
  compiled code at target\run\mini_project\models\intermediate_joins\outer_join.sql
[0m13:53:10.569837 [info ] [MainThread]: 
[0m13:53:10.569837 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:53:10.569837 [debug] [MainThread]: Command `dbt run` failed at 13:53:10.569837 after 7.41 seconds
[0m13:53:10.569837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CC67DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CD1E9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000113CF340BF0>]}
[0m13:53:10.569837 [debug] [MainThread]: Flushing usage events
[0m13:53:11.563799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:21.580111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDC554890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDC557200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDC556960>]}


============================== 14:00:21.596759 | eaadfce7-5522-4e8e-ae62-4c669191b691 ==============================
[0m14:00:21.596759 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:00:21.596759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:22.113851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDD377BC0>]}
[0m14:00:22.197356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDCFE7830>]}
[0m14:00:22.197356 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:00:22.768559 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m14:00:22.868636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:00:22.868636 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m14:00:22.868636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDC1D3500>]}
[0m14:00:24.471225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDE6B2270>]}
[0m14:00:24.557179 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:00:24.571445 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:00:24.599725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDE9B87A0>]}
[0m14:00:24.599725 [info ] [MainThread]: Found 7 models, 3 sources, 476 macros
[0m14:00:24.599725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDE6A24E0>]}
[0m14:00:24.612612 [info ] [MainThread]: 
[0m14:00:24.614917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:24.615823 [info ] [MainThread]: 
[0m14:00:24.616417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:24.618139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m14:00:24.733176 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m14:00:24.733176 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m14:00:24.733176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:25.550895 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.812 seconds
[0m14:00:25.557784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m14:00:25.573365 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m14:00:25.573365 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m14:00:25.573365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:25.917660 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.353 seconds
[0m14:00:25.934028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_RAW)
[0m14:00:25.934878 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m14:00:25.934878 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m14:00:26.034276 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.092 seconds
[0m14:00:26.035893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_staging)
[0m14:00:26.035893 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m14:00:26.035893 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m14:00:26.168285 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.126 seconds
[0m14:00:26.168285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDE9624B0>]}
[0m14:00:26.174500 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m14:00:26.174500 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate_joins.outer_join ..................... [RUN]
[0m14:00:26.174500 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.outer_join'
[0m14:00:26.174500 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m14:00:26.187577 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m14:00:26.188585 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m14:00:26.218044 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m14:00:26.233225 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m14:00:26.234125 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by payment_month
        );
[0m14:00:26.234682 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:27.558668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.328 seconds
[0m14:00:27.602788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eaadfce7-5522-4e8e-ae62-4c669191b691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD9A4E0F0>]}
[0m14:00:27.602788 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate_joins.outer_join ................ [[32mSUCCESS 1[0m in 1.43s]
[0m14:00:27.602788 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m14:00:27.602788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:27.602788 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m14:00:27.602788 [debug] [MainThread]: On list_mini_project: Close
[0m14:00:27.703359 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m14:00:27.703359 [debug] [MainThread]: On list_mini_project_staging: Close
[0m14:00:27.803287 [debug] [MainThread]: Connection 'model.mini_project.outer_join' was left open.
[0m14:00:27.818244 [debug] [MainThread]: On model.mini_project.outer_join: Close
[0m14:00:27.921016 [info ] [MainThread]: 
[0m14:00:27.921016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m14:00:27.921016 [debug] [MainThread]: Command end result
[0m14:00:27.958888 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:00:27.958888 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:00:27.971155 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m14:00:27.971155 [info ] [MainThread]: 
[0m14:00:27.971155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:27.973353 [info ] [MainThread]: 
[0m14:00:27.973353 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:00:27.975365 [debug] [MainThread]: Command `cli run` succeeded at 14:00:27.975365 after 6.61 seconds
[0m14:00:27.975365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDBB2CB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDC3E2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBDF06BBC0>]}
[0m14:00:27.975365 [debug] [MainThread]: Flushing usage events
[0m14:00:29.377656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:44.722042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0BE83230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0B415640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0B447080>]}


============================== 14:19:44.722042 | b8960f0a-c44c-4929-af47-477ced4a1b45 ==============================
[0m14:19:44.722042 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:19:44.722042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:19:45.255693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0CD093A0>]}
[0m14:19:45.339131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0C383EC0>]}
[0m14:19:45.339131 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:19:45.906386 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m14:19:46.006425 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:19:46.006425 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m14:19:46.006425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E45E3C0>]}
[0m14:19:47.608123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0BF25100>]}
[0m14:19:47.691473 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:19:47.716730 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:19:47.741544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0C3573B0>]}
[0m14:19:47.741544 [info ] [MainThread]: Found 7 models, 3 sources, 476 macros
[0m14:19:47.741544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E51A090>]}
[0m14:19:47.741544 [info ] [MainThread]: 
[0m14:19:47.741544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:47.741544 [info ] [MainThread]: 
[0m14:19:47.741544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:47.756941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m14:19:47.875115 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m14:19:47.875115 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m14:19:47.875115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:48.663669 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.786 seconds
[0m14:19:48.676991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m14:19:48.692561 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m14:19:48.692561 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m14:19:48.692561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:49.176949 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.483 seconds
[0m14:19:49.176949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m14:19:49.176949 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m14:19:49.176949 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m14:19:49.311599 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.122 seconds
[0m14:19:49.313672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_RAW)
[0m14:19:49.327484 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m14:19:49.327484 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m14:19:49.444714 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.115 seconds
[0m14:19:49.444714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E532030>]}
[0m14:19:49.461040 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m14:19:49.461040 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.kpi1_lm ........................................ [RUN]
[0m14:19:49.461040 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1_lm'
[0m14:19:49.473594 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m14:19:49.484089 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m14:19:49.484089 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m14:19:49.526778 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m14:19:49.526778 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m14:19:49.526778 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace   view mini_project.RAW.kpi1_lm
  
   as (
    WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    *,
    select TOTAL_REVENUE from mini_project.intermediate_joins.join
    where PAYMENT_MONTH=previous_month AND CUSTOMER_ID=customer_id and product_id=product_id as previous_month_response
    FROM
    BASE
)
SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
  );
[0m14:19:49.526778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:19:50.058987 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb1-3201-7e9a-000c-3d6e0002526a
[0m14:19:50.058987 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 4 unexpected 'select'.
syntax error line 24 at position 93 unexpected 'as'.
[0m14:19:50.060447 [debug] [Thread-1 (]: Database Error in model kpi1_lm (models\mart\kpi1_lm.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'select'.
  syntax error line 24 at position 93 unexpected 'as'.
  compiled code at target\run\mini_project\models\mart\kpi1_lm.sql
[0m14:19:50.060447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8960f0a-c44c-4929-af47-477ced4a1b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0E62FB30>]}
[0m14:19:50.060447 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.kpi1_lm ............................... [[31mERROR[0m in 0.60s]
[0m14:19:50.060447 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m14:19:50.060447 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.kpi1_lm' to be skipped because of status 'error'.  Reason: Database Error in model kpi1_lm (models\mart\kpi1_lm.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'select'.
  syntax error line 24 at position 93 unexpected 'as'.
  compiled code at target\run\mini_project\models\mart\kpi1_lm.sql.
[0m14:19:50.060447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:50.060447 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m14:19:50.060447 [debug] [MainThread]: On list_mini_project: Close
[0m14:19:50.179599 [debug] [MainThread]: Connection 'list_mini_project_RAW' was left open.
[0m14:19:50.179599 [debug] [MainThread]: On list_mini_project_RAW: Close
[0m14:19:50.299554 [debug] [MainThread]: Connection 'model.mini_project.kpi1_lm' was left open.
[0m14:19:50.299554 [debug] [MainThread]: On model.mini_project.kpi1_lm: Close
[0m14:19:50.406455 [info ] [MainThread]: 
[0m14:19:50.408478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m14:19:50.410501 [debug] [MainThread]: Command end result
[0m14:19:50.444889 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:19:50.460524 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:19:50.460524 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m14:19:50.460524 [info ] [MainThread]: 
[0m14:19:50.460524 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:19:50.460524 [info ] [MainThread]: 
[0m14:19:50.460524 [error] [MainThread]:   Database Error in model kpi1_lm (models\mart\kpi1_lm.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 4 unexpected 'select'.
  syntax error line 24 at position 93 unexpected 'as'.
  compiled code at target\run\mini_project\models\mart\kpi1_lm.sql
[0m14:19:50.460524 [info ] [MainThread]: 
[0m14:19:50.460524 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:50.460524 [debug] [MainThread]: Command `cli run` failed at 14:19:50.460524 after 5.97 seconds
[0m14:19:50.475471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0B415640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0B7E3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C0B7E2330>]}
[0m14:19:50.475471 [debug] [MainThread]: Flushing usage events
[0m14:19:51.446492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:17.180585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AAFFA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AD28F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AD28E570>]}


============================== 14:21:17.180585 | c78e6b35-98fe-4075-accf-45f7b7a2fea4 ==============================
[0m14:21:17.180585 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:21:17.180585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:17.750293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AD883AA0>]}
[0m14:21:17.830642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AD1B22D0>]}
[0m14:21:17.832160 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:21:18.298343 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m14:21:18.398558 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:21:18.398558 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m14:21:18.398558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AD883530>]}
[0m14:21:19.966749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AFFC6F30>]}
[0m14:21:20.050180 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:21:20.050180 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:21:20.083515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AFDE9AC0>]}
[0m14:21:20.088139 [info ] [MainThread]: Found 7 models, 3 sources, 476 macros
[0m14:21:20.088139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c78e6b35-98fe-4075-accf-45f7b7a2fea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192AE92F440>]}
[0m14:21:20.090149 [info ] [MainThread]: 
[0m14:21:20.090149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:20.090149 [info ] [MainThread]: 
[0m14:21:20.092159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:20.092159 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m14:21:20.201555 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m14:21:20.201555 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m14:21:20.216430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:21.097507 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.882 seconds
[0m14:21:21.102512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m14:21:21.122321 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m14:21:21.122321 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m14:21:21.122321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:21.569564 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.454 seconds
[0m14:21:21.586265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m14:21:21.586265 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m14:21:21.586265 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m14:21:21.688595 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.087 seconds
[0m14:21:21.690608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_RAW)
[0m14:39:16.750137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002469726E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246973522D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024697352270>]}


============================== 14:39:16.750137 | 73fdeb43-5f75-4fd3-aea3-3bdf816e25b9 ==============================
[0m14:39:16.750137 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:39:16.750137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:39:17.296156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024697E262A0>]}
[0m14:39:17.377917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024699CA0470>]}
[0m14:39:17.379925 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:39:17.944984 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m14:39:18.051383 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:39:18.051383 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m14:39:18.051383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024699F4DD00>]}
[0m14:39:19.690140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002469A077E30>]}
[0m14:39:19.774867 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:39:19.805509 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:39:19.838092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002469A16A1E0>]}
[0m14:39:19.838092 [info ] [MainThread]: Found 8 models, 3 sources, 476 macros
[0m14:39:19.838092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002469A0224E0>]}
[0m14:39:19.838092 [info ] [MainThread]: 
[0m14:39:19.838092 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:19.838092 [info ] [MainThread]: 
[0m14:39:19.838092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:19.838092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m14:39:19.961938 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m14:39:19.961938 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m14:39:19.961938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:20.940790 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.980 seconds
[0m14:39:20.956891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m14:39:20.962178 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m14:39:20.962178 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m14:39:20.962178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:21.396296 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.430 seconds
[0m14:39:21.396296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_RAW)
[0m14:39:21.396296 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m14:39:21.396296 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m14:39:21.628595 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.222 seconds
[0m14:39:21.628595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_intermediate_joins)
[0m14:39:21.635881 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m14:39:21.635881 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m14:39:21.716031 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.081 seconds
[0m14:39:21.716031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024698BBEA80>]}
[0m14:39:21.724855 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m14:39:21.724855 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.kpi1_lm ........................................ [RUN]
[0m14:39:21.724855 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1_lm'
[0m14:39:21.724855 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m14:39:21.738004 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m14:39:21.738004 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m14:39:21.776759 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m14:39:21.776759 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m14:39:21.776759 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace   view mini_project.RAW.kpi1_lm
  
   as (
    WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
  );
[0m14:39:21.776759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:22.266609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m14:39:22.314078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73fdeb43-5f75-4fd3-aea3-3bdf816e25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246951EA600>]}
[0m14:39:22.314078 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.kpi1_lm ................................... [[32mSUCCESS 1[0m in 0.59s]
[0m14:39:22.325779 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m14:39:22.325779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:22.325779 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m14:39:22.325779 [debug] [MainThread]: On list_mini_project: Close
[0m14:39:22.429045 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m14:39:22.429045 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m14:39:22.557317 [debug] [MainThread]: Connection 'model.mini_project.kpi1_lm' was left open.
[0m14:39:22.557317 [debug] [MainThread]: On model.mini_project.kpi1_lm: Close
[0m14:39:22.677662 [info ] [MainThread]: 
[0m14:39:22.679685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m14:39:22.683733 [debug] [MainThread]: Command end result
[0m14:39:22.716527 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m14:39:22.725301 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m14:39:22.729508 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m14:39:22.729508 [info ] [MainThread]: 
[0m14:39:22.729508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:22.729508 [info ] [MainThread]: 
[0m14:39:22.729508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:22.729508 [debug] [MainThread]: Command `cli run` succeeded at 14:39:22.729508 after 6.21 seconds
[0m14:39:22.729508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024697B72AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024697352270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246973522D0>]}
[0m14:39:22.729508 [debug] [MainThread]: Flushing usage events
[0m14:39:23.723220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:59.028230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341092270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341D32AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341E2B7A0>]}


============================== 15:19:59.028230 | 1465ed20-9971-4881-abf2-88b29dc231f7 ==============================
[0m15:19:59.028230 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:19:59.028230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:19:59.567777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533F37F380>]}
[0m15:19:59.645501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015342C99DC0>]}
[0m15:19:59.645501 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:20:00.224435 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m15:20:00.337079 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:20:00.337079 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m15:20:00.337079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015341AFF770>]}
[0m15:20:01.965599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153442537A0>]}
[0m15:20:02.055963 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:20:02.087387 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:20:02.119107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001534425B230>]}
[0m15:20:02.119107 [info ] [MainThread]: Found 9 models, 3 sources, 476 macros
[0m15:20:02.119107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015343D58170>]}
[0m15:20:02.119107 [info ] [MainThread]: 
[0m15:20:02.119107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:02.119107 [info ] [MainThread]: 
[0m15:20:02.119107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:02.134379 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m15:20:02.257617 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m15:20:02.257617 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m15:20:02.257617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:03.155562 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.890 seconds
[0m15:20:03.175452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m15:20:03.187199 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m15:20:03.187199 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m15:20:03.187199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:03.661096 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.466 seconds
[0m15:20:03.664072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_RAW)
[0m15:20:03.666360 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m15:20:03.669923 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m15:20:03.739471 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.083 seconds
[0m15:20:03.760582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_intermediate_joins)
[0m15:20:03.770264 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m15:20:03.776316 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m15:20:03.861322 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.089 seconds
[0m15:20:03.861322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015344245BB0>]}
[0m15:20:03.874523 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m15:20:03.875416 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate_joins.outer_join ..................... [RUN]
[0m15:20:03.876790 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.outer_join'
[0m15:20:03.876790 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m15:20:03.887496 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m15:20:03.887496 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m15:20:03.926394 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m15:20:03.926394 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m15:20:03.926394 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by CUSTOMER_ID,PAYMENT_MONTH
        );
[0m15:20:03.926394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:05.075627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.146 seconds
[0m15:20:05.104683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1465ed20-9971-4881-abf2-88b29dc231f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533F37E390>]}
[0m15:20:05.104683 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate_joins.outer_join ................ [[32mSUCCESS 1[0m in 1.23s]
[0m15:20:05.104683 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m15:20:05.104683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:05.104683 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m15:20:05.104683 [debug] [MainThread]: On list_mini_project: Close
[0m15:20:05.239950 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m15:20:05.239950 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m15:20:05.352523 [debug] [MainThread]: Connection 'model.mini_project.outer_join' was left open.
[0m15:20:05.352523 [debug] [MainThread]: On model.mini_project.outer_join: Close
[0m15:20:05.480661 [info ] [MainThread]: 
[0m15:20:05.480661 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m15:20:05.480661 [debug] [MainThread]: Command end result
[0m15:20:05.533148 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:20:05.533148 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:20:05.543174 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m15:20:05.543174 [info ] [MainThread]: 
[0m15:20:05.543174 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:05.543174 [info ] [MainThread]: 
[0m15:20:05.543174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:05.543174 [debug] [MainThread]: Command `cli run` succeeded at 15:20:05.543174 after 6.75 seconds
[0m15:20:05.543174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001533F27A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153442C5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153442B96A0>]}
[0m15:20:05.543174 [debug] [MainThread]: Flushing usage events
[0m15:20:06.777166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:54.987990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13B95670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13B954C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13B94500>]}


============================== 15:23:54.991737 | 697cee4d-3618-4da7-841f-c7065ad52dc1 ==============================
[0m15:23:54.991737 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:23:54.994332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:55.552335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E13B94BF0>]}
[0m15:23:55.620920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1476D970>]}
[0m15:23:55.620920 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:23:56.096078 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m15:23:56.201121 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:23:56.201121 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m15:23:56.201121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E136F3530>]}
[0m15:23:57.787139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E15DCCDA0>]}
[0m15:23:57.878108 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:23:57.878108 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:23:57.915193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E15973470>]}
[0m15:23:57.918871 [info ] [MainThread]: Found 10 models, 3 sources, 476 macros
[0m15:23:57.918871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E15DCF3B0>]}
[0m15:23:57.920880 [info ] [MainThread]: 
[0m15:23:57.920880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:57.922631 [info ] [MainThread]: 
[0m15:23:57.922631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:23:57.922631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m15:23:58.038040 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m15:23:58.038040 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m15:23:58.038040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:58.867823 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.824 seconds
[0m15:23:58.880462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m15:23:58.886477 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m15:23:58.886477 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m15:23:58.886477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:59.326888 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.433 seconds
[0m15:23:59.326888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_RAW)
[0m15:23:59.326888 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m15:23:59.326888 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m15:23:59.422614 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.103 seconds
[0m15:23:59.438454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_staging)
[0m15:23:59.438454 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m15:23:59.438454 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m15:23:59.526414 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.083 seconds
[0m15:23:59.534503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E11020440>]}
[0m15:23:59.540508 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m15:23:59.540508 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate_joins.outer_join ..................... [RUN]
[0m15:23:59.540508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.outer_join'
[0m15:23:59.540508 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m15:23:59.540508 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m15:23:59.540508 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m15:23:59.592768 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m15:23:59.592768 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m15:23:59.592768 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by CUSTOMER_ID,PAYMENT_MONTH
        );
[0m15:23:59.592768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:00.722830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.135 seconds
[0m15:24:00.770546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '697cee4d-3618-4da7-841f-c7065ad52dc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E10F6A5A0>]}
[0m15:24:00.770546 [info ] [Thread-1 (]: 1 of 1 OK created sql table model intermediate_joins.outer_join ................ [[32mSUCCESS 1[0m in 1.23s]
[0m15:24:00.770546 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m15:24:00.770546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:00.770546 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m15:24:00.770546 [debug] [MainThread]: On list_mini_project: Close
[0m15:24:00.904224 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m15:24:00.904224 [debug] [MainThread]: On list_mini_project_staging: Close
[0m15:24:01.013170 [debug] [MainThread]: Connection 'model.mini_project.outer_join' was left open.
[0m15:24:01.013170 [debug] [MainThread]: On model.mini_project.outer_join: Close
[0m15:24:01.146564 [info ] [MainThread]: 
[0m15:24:01.146564 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m15:24:01.146564 [debug] [MainThread]: Command end result
[0m15:24:01.180888 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:24:01.194416 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:24:01.194416 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m15:24:01.194416 [info ] [MainThread]: 
[0m15:24:01.194416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:01.194416 [info ] [MainThread]: 
[0m15:24:01.194416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:24:01.194416 [debug] [MainThread]: Command `cli run` succeeded at 15:24:01.194416 after 6.43 seconds
[0m15:24:01.194416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E15D5D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E148E7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E162D8770>]}
[0m15:24:01.194416 [debug] [MainThread]: Flushing usage events
[0m15:24:02.165319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:32.596037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DA9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DA9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DA96D0>]}


============================== 15:50:32.604290 | f5787054-270e-45cc-86f2-82694b0a58b9 ==============================
[0m15:50:32.604290 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:50:32.605377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:mt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:33.953929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4319ABD0>]}
[0m15:50:34.032390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DD6720>]}
[0m15:50:34.034556 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:50:34.648021 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:50:34.750748 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:50:34.751750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4591B320>]}
[0m15:50:37.125271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA47FD0320>]}
[0m15:50:37.211667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:50:37.233628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:50:37.305262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA47FEBE00>]}
[0m15:50:37.306262 [info ] [MainThread]: Found 11 models, 3 sources, 474 macros
[0m15:50:37.307261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA47D4E150>]}
[0m15:50:37.309499 [info ] [MainThread]: 
[0m15:50:37.310383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:37.311392 [info ] [MainThread]: 
[0m15:50:37.312392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:37.318647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m15:50:38.660192 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m15:50:38.660192 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m15:50:38.661193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:39.566667 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.906 seconds
[0m15:50:39.574377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_mart)
[0m15:50:39.577790 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "mart"
"
[0m15:50:39.594939 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_mart"
[0m15:50:39.595930 [debug] [ThreadPool]: On create_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "create_mini_project_mart"} */
create schema if not exists mini_project.mart
[0m15:50:39.742888 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m15:50:39.747065 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m15:50:39.758824 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m15:50:39.759934 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m15:50:39.759934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:40.197445 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.437 seconds
[0m15:50:40.200695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m15:50:40.203792 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m15:50:40.204792 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m15:50:40.337335 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.132 seconds
[0m15:50:40.345326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_mart)
[0m15:50:40.356319 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m15:50:40.357383 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m15:50:40.482265 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.123 seconds
[0m15:50:40.489041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA48349280>]}
[0m15:50:40.497675 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m15:50:40.499675 [info ] [Thread-1 (]: 1 of 4 START sql table model mart.kpi1_lm ...................................... [RUN]
[0m15:50:40.502108 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1_lm'
[0m15:50:40.504059 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m15:50:40.515532 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m15:50:40.517532 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m15:50:40.556640 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m15:50:40.559640 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m15:50:40.559640 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace transient table mini_project.mart.kpi1_lm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m15:50:40.560640 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:42.676976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.116 seconds
[0m15:50:42.705499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA43199C70>]}
[0m15:50:42.706508 [info ] [Thread-1 (]: 1 of 4 OK created sql table model mart.kpi1_lm ................................. [[32mSUCCESS 1[0m in 2.20s]
[0m15:50:42.707508 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m15:50:42.707508 [debug] [Thread-1 (]: Began running node model.mini_project.newlogos_kpi
[0m15:50:42.708722 [info ] [Thread-1 (]: 2 of 4 START sql table model mart.newlogos_kpi ................................. [RUN]
[0m15:50:42.714140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_lm, now model.mini_project.newlogos_kpi)
[0m15:50:42.715177 [debug] [Thread-1 (]: Began compiling node model.mini_project.newlogos_kpi
[0m15:50:42.718404 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.newlogos_kpi"
[0m15:50:42.720371 [debug] [Thread-1 (]: Began executing node model.mini_project.newlogos_kpi
[0m15:50:42.724407 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.newlogos_kpi"
[0m15:50:42.726404 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.newlogos_kpi"
[0m15:50:42.726404 [debug] [Thread-1 (]: On model.mini_project.newlogos_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.newlogos_kpi"} */
create or replace transient table mini_project.mart.newlogos_kpi
         as
        (WITH FIRST_PURCHASE AS (
    SELECT 
        CUSTOMER_ID,
        MIN(PAYMENT_MONTH) AS FIRST_PURCHASE
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID
)
SELECT
    YEAR(FIRST_PURCHASE) AS FISCAL_YEAR,
    COUNT(CUSTOMER_ID) AS NEW_CUSTOMERS
FROM FIRST_PURCHASE
GROUP BY FISCAL_YEAR
        );
[0m15:50:43.413927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m15:50:43.418256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA47ED8A70>]}
[0m15:50:43.420252 [info ] [Thread-1 (]: 2 of 4 OK created sql table model mart.newlogos_kpi ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m15:50:43.422613 [debug] [Thread-1 (]: Finished running node model.mini_project.newlogos_kpi
[0m15:50:43.423614 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m15:50:43.424617 [info ] [Thread-1 (]: 3 of 4 START sql table model mart.ranking_customers_based_on_revenue_kpi ....... [RUN]
[0m15:50:43.426073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.newlogos_kpi, now model.mini_project.ranking_customers_based_on_revenue_kpi)
[0m15:50:43.428117 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m15:50:43.433102 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m15:50:43.434071 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m15:50:43.437293 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m15:50:43.439263 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m15:50:43.440261 [debug] [Thread-1 (]: On model.mini_project.ranking_customers_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_customers_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_customers_based_on_revenue_kpi
         as
        (WITH CUSTOMER_REVENUE AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        ROUND(SUM(TOTAL_REVENUE),3) AS TOTAL_REVENUE_BY_CUSTOMER
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID,CUSTOMER_NAME
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_CUSTOMER DESC) AS RANK
FROM 
CUSTOMER_REVENUE
        );
[0m15:50:43.976106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m15:50:43.979082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4872DD00>]}
[0m15:50:43.980286 [info ] [Thread-1 (]: 3 of 4 OK created sql table model mart.ranking_customers_based_on_revenue_kpi .. [[32mSUCCESS 1[0m in 0.55s]
[0m15:50:43.981252 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m15:50:43.982286 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m15:50:43.982286 [info ] [Thread-1 (]: 4 of 4 START sql table model mart.ranking_products_based_on_revenue_kpi ........ [RUN]
[0m15:50:43.983284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_customers_based_on_revenue_kpi, now model.mini_project.ranking_products_based_on_revenue_kpi)
[0m15:50:43.984455 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_products_based_on_revenue_kpi
[0m15:50:43.987489 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m15:50:43.989662 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_products_based_on_revenue_kpi
[0m15:50:43.992708 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m15:50:43.995437 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m15:50:43.995437 [debug] [Thread-1 (]: On model.mini_project.ranking_products_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_products_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_products_based_on_revenue_kpi
         as
        (WITH PRODUCT_REVENUE AS (
    SELECT
        PRODUCT_ID,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE_BY_PRODUCT
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY PRODUCT_ID
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_PRODUCT DESC) AS RANK
FROM 
PRODUCT_REVENUE
        );
[0m15:50:44.543836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m15:50:44.546860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5787054-270e-45cc-86f2-82694b0a58b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA485A5160>]}
[0m15:50:44.547989 [info ] [Thread-1 (]: 4 of 4 OK created sql table model mart.ranking_products_based_on_revenue_kpi ... [[32mSUCCESS 1[0m in 0.56s]
[0m15:50:44.548953 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m15:50:44.550954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:44.550954 [debug] [MainThread]: Connection 'create_mini_project_mart' was left open.
[0m15:50:44.550954 [debug] [MainThread]: On create_mini_project_mart: Close
[0m15:50:44.659055 [debug] [MainThread]: Connection 'list_mini_project_mart' was left open.
[0m15:50:44.659055 [debug] [MainThread]: On list_mini_project_mart: Close
[0m15:50:44.773113 [debug] [MainThread]: Connection 'model.mini_project.ranking_products_based_on_revenue_kpi' was left open.
[0m15:50:44.774112 [debug] [MainThread]: On model.mini_project.ranking_products_based_on_revenue_kpi: Close
[0m15:50:44.885427 [info ] [MainThread]: 
[0m15:50:44.886391 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.57 seconds (7.57s).
[0m15:50:44.888428 [debug] [MainThread]: Command end result
[0m15:50:44.917651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m15:50:44.920739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m15:50:44.928738 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m15:50:44.929740 [info ] [MainThread]: 
[0m15:50:44.930741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:44.931738 [info ] [MainThread]: 
[0m15:50:44.932740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:50:44.934740 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:44.934740 after 12.56 seconds
[0m15:50:44.935770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA47BCB4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DA87A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA45DA9850>]}
[0m15:50:44.935770 [debug] [MainThread]: Flushing usage events
[0m15:50:46.007159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:09.572114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C3990AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C3992BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C3993F80>]}


============================== 16:21:09.578139 | 79768feb-46d6-4758-b84e-7f62bb29c803 ==============================
[0m16:21:09.578139 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:21:09.578139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:21:10.107917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C120F380>]}
[0m16:21:10.189248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C33A2570>]}
[0m16:21:10.189248 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:21:10.758264 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m16:21:10.869730 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:21:10.869730 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m16:21:10.869730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C5EFB290>]}
[0m16:21:12.465944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C5C6B0E0>]}
[0m16:21:12.560705 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:21:12.583377 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:21:12.610886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C60994C0>]}
[0m16:21:12.610886 [info ] [MainThread]: Found 11 models, 3 sources, 476 macros
[0m16:21:12.610886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C60A35F0>]}
[0m16:21:12.610886 [info ] [MainThread]: 
[0m16:21:12.610886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:21:12.610886 [info ] [MainThread]: 
[0m16:21:12.622867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:12.622867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m16:21:12.748221 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:21:12.748221 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:21:12.748221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:13.535532 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.792 seconds
[0m16:21:13.551182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m16:21:13.562566 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m16:21:13.562566 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m16:21:13.562566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:13.999465 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.435 seconds
[0m16:21:13.999465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m16:21:13.999465 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m16:21:13.999465 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m16:21:14.121914 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.126 seconds
[0m16:21:14.121914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m16:21:14.139894 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m16:21:14.139894 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m16:21:14.246971 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.117 seconds
[0m16:21:14.262102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C4A58D40>]}
[0m16:21:14.264091 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m16:21:14.264091 [info ] [Thread-1 (]: 1 of 1 START sql table model intermediate_joins.month_revenue .................. [RUN]
[0m16:21:14.264091 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.month_revenue'
[0m16:21:14.264091 [debug] [Thread-1 (]: Began compiling node model.mini_project.month_revenue
[0m16:21:14.278782 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.month_revenue"
[0m16:21:14.281182 [debug] [Thread-1 (]: Began executing node model.mini_project.month_revenue
[0m16:21:14.313298 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.month_revenue"
[0m16:21:14.327854 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.month_revenue"
[0m16:21:14.327854 [debug] [Thread-1 (]: On model.mini_project.month_revenue: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.month_revenue"} */
create or replace transient table mini_project.intermediate_joins.month_revenue
         as
        (SELECT 
    customer_id,
    product_id,
    payment_month,
    SUM(revenue) AS total_revenue
FROM 
    mini_project.intermediate_joins.join
GROUP BY 
    customer_id, 
    payment_month
ORDER BY 
    customer_id, 
    product_id, 
    payment_month
        );
[0m16:21:14.327854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:21:14.864685 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002b-3201-7d7b-000c-3d6e000246da
[0m16:21:14.864685 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 5 at position 4
'JOIN.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
[0m16:21:14.864685 [debug] [Thread-1 (]: Database Error in model month_revenue (models\intermediate_joins\month_revenue.sql)
  001104 (42601): SQL compilation error: error line 5 at position 4
  'JOIN.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\mini_project\models\intermediate_joins\month_revenue.sql
[0m16:21:14.879952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79768feb-46d6-4758-b84e-7f62bb29c803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C33143E0>]}
[0m16:21:14.880330 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model intermediate_joins.month_revenue ......... [[31mERROR[0m in 0.60s]
[0m16:21:14.880330 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m16:21:14.880330 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.month_revenue' to be skipped because of status 'error'.  Reason: Database Error in model month_revenue (models\intermediate_joins\month_revenue.sql)
  001104 (42601): SQL compilation error: error line 5 at position 4
  'JOIN.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\mini_project\models\intermediate_joins\month_revenue.sql.
[0m16:21:14.880330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:14.880330 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m16:21:14.880330 [debug] [MainThread]: On list_mini_project: Close
[0m16:21:14.991323 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m16:21:14.993339 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m16:21:15.110687 [debug] [MainThread]: Connection 'model.mini_project.month_revenue' was left open.
[0m16:21:15.112709 [debug] [MainThread]: On model.mini_project.month_revenue: Close
[0m16:21:15.220213 [info ] [MainThread]: 
[0m16:21:15.220213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m16:21:15.231213 [debug] [MainThread]: Command end result
[0m16:21:15.252868 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:21:15.265629 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:21:15.265629 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m16:21:15.265629 [info ] [MainThread]: 
[0m16:21:15.265629 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:21:15.277004 [info ] [MainThread]: 
[0m16:21:15.277004 [error] [MainThread]:   Database Error in model month_revenue (models\intermediate_joins\month_revenue.sql)
  001104 (42601): SQL compilation error: error line 5 at position 4
  'JOIN.PRODUCT_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\mini_project\models\intermediate_joins\month_revenue.sql
[0m16:21:15.277004 [info ] [MainThread]: 
[0m16:21:15.277004 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:21:15.280808 [debug] [MainThread]: Command `cli run` failed at 16:21:15.280808 after 5.94 seconds
[0m16:21:15.282822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C13ECBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5C4B1FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5BDC773B0>]}
[0m16:21:15.282822 [debug] [MainThread]: Flushing usage events
[0m16:21:16.681399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:10.221946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0974AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0974BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0974B890>]}


============================== 16:54:10.221946 | 48be5f14-7b51-412d-849d-966a7acdb2b3 ==============================
[0m16:54:10.221946 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:54:10.221946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:11.544148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0A948590>]}
[0m16:54:11.623857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0A899130>]}
[0m16:54:11.623857 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:54:12.225824 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:54:12.328332 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:54:12.328332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0A898320>]}
[0m16:54:14.587499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E07057200>]}
[0m16:54:14.666670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:54:14.698869 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:54:14.761933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0BE0E6F0>]}
[0m16:54:14.761933 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m16:54:14.761933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0A82EF60>]}
[0m16:54:14.764541 [info ] [MainThread]: 
[0m16:54:14.764541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:14.764541 [info ] [MainThread]: 
[0m16:54:14.769888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:14.777068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m16:54:16.098804 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:54:16.098804 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:54:16.098804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:16.922748 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.836 seconds
[0m16:54:16.940808 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:54:16.940808 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:54:17.055093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m16:54:17.059104 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:54:17.061110 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:54:17.114154 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.067 seconds
[0m16:54:17.129842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m16:54:17.145551 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m16:54:17.145551 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m16:54:17.145551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:17.879402 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.731 seconds
[0m16:54:17.888087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate_joins)
[0m16:54:17.891902 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m16:54:17.891902 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m16:54:18.002898 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.102 seconds
[0m16:54:18.010963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m16:54:18.021442 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m16:54:18.021442 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m16:54:18.117128 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.095 seconds
[0m16:54:18.120764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0BE32420>]}
[0m16:54:18.120764 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m16:54:18.120764 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.customers ................................ [RUN]
[0m16:54:18.120764 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m16:54:18.120764 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m16:54:18.138970 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m16:54:18.140978 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m16:54:18.183798 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m16:54:18.185804 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m16:54:18.185804 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace transient table mini_project.staging.customers
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
    WHERE customer_id IS NOT NULL AND company IS NOT NULL AND customer_name IS NOT NULL
    ORDER BY customer_id
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
CUSTOMER_NAME,
COMPANY
FROM RAW_FORM
        );
[0m16:54:18.186809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:19.139319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m16:54:19.173399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0BD93320>]}
[0m16:54:19.174401 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.customers ........................... [[32mSUCCESS 1[0m in 1.05s]
[0m16:54:19.183398 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m16:54:19.183398 [debug] [Thread-1 (]: Began running node model.mini_project.products
[0m16:54:19.184398 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.products ................................. [RUN]
[0m16:54:19.198672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customers, now model.mini_project.products)
[0m16:54:19.198672 [debug] [Thread-1 (]: Began compiling node model.mini_project.products
[0m16:54:19.204826 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.products"
[0m16:54:19.206584 [debug] [Thread-1 (]: Began executing node model.mini_project.products
[0m16:54:19.210628 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.products"
[0m16:54:19.212596 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.products"
[0m16:54:19.212596 [debug] [Thread-1 (]: On model.mini_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.products"} */
create or replace transient table mini_project.staging.products
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_PRODUCTS
    WHERE PRODUCT_ID IS NOT NULL AND PRODUCT_FAMILY IS NOT NULL AND PRODUCT_SUB_FAMILY IS NOT NULL
    ORDER BY PRODUCT_ID
)
SELECT
*
FROM
RAW_FORM
        );
[0m16:54:19.874285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m16:54:19.882380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C49E510>]}
[0m16:54:19.884402 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.products ............................ [[32mSUCCESS 1[0m in 0.68s]
[0m16:54:19.886425 [debug] [Thread-1 (]: Finished running node model.mini_project.products
[0m16:54:19.886425 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m16:54:19.886425 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.transactions ............................. [RUN]
[0m16:54:19.896439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.products, now model.mini_project.transactions)
[0m16:54:19.898291 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m16:54:19.909095 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m16:54:19.912559 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m16:54:19.919655 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m16:54:19.923752 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m16:54:19.924767 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
    WHERE
    CUSTOMER_ID IS NOT NULL AND 
    PRODUCT_ID IS NOT NULL AND 
    PAYMENT_MONTH IS NOT NULL AND 
    REVENUE_TYPE IS NOT NULL AND 
    REVENUE IS NOT NULL AND 
    QUANTITY IS NOT NULL AND
    DIMENSION_1 IS NOT NULL AND
    DIMENSION_2 IS NOT NULL AND
    DIMENSION_3 IS NOT NULL AND
    DIMENSION_4 IS NOT NULL AND
    DIMENSION_5 IS NOT NULL AND
    DIMENSION_6 IS NOT NULL AND
    DIMENSION_7 IS NOT NULL AND
    DIMENSION_8 IS NOT NULL AND
    DIMENSION_9 IS NOT NULL AND
    DIMENSION_10 IS NOT NULL AND
    COMPANIES IS NOT NULL
    ORDER BY PAYMENT_MONTH
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
PRODUCT_ID,
TRY_TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
CAST(REVENUE_TYPE AS SMALLINT) AS REVENUE_TYPE,
CAST(REVENUE AS FLOAT) AS REVENUE,
CAST(QUANTITY AS SMALLINT) AS QUANTITY,
COMPANIES
FROM RAW_FORM
        );
[0m16:54:20.727103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.808 seconds
[0m16:54:20.736699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0A8CCDD0>]}
[0m16:54:20.736699 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.transactions ........................ [[32mSUCCESS 1[0m in 0.83s]
[0m16:54:20.736699 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m16:54:20.736699 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m16:54:20.736699 [info ] [Thread-1 (]: 4 of 14 START sql table model intermediate_joins.join .......................... [RUN]
[0m16:54:20.736699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.transactions, now model.mini_project.join)
[0m16:54:20.736699 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m16:54:20.736699 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m16:54:20.736699 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m16:54:20.736699 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m16:54:20.752624 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m16:54:20.753729 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
where REVENUE_TYPE=1
order by customer_id
        );
[0m16:54:21.611139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.866 seconds
[0m16:54:21.624549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C55B050>]}
[0m16:54:21.624549 [info ] [Thread-1 (]: 4 of 14 OK created sql table model intermediate_joins.join ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m16:54:21.624549 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m16:54:21.624549 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m16:54:21.624549 [info ] [Thread-1 (]: 5 of 14 START sql table model intermediate_joins.month_revenue ................. [RUN]
[0m16:54:21.624549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.join, now model.mini_project.month_revenue)
[0m16:54:21.634910 [debug] [Thread-1 (]: Began compiling node model.mini_project.month_revenue
[0m16:54:21.639294 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.month_revenue"
[0m16:54:21.641303 [debug] [Thread-1 (]: Began executing node model.mini_project.month_revenue
[0m16:54:21.643887 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.month_revenue"
[0m16:54:21.646456 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.month_revenue"
[0m16:54:21.647487 [debug] [Thread-1 (]: On model.mini_project.month_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.month_revenue"} */
create or replace transient table mini_project.intermediate_joins.month_revenue
         as
        (SELECT 
    customer_id,
    product_id,
    payment_month,
    SUM(revenue) AS total_revenue
FROM 
    mini_project.intermediate_joins.join
GROUP BY 
    customer_id, 
    product_id,
    payment_month
ORDER BY 
    customer_id, 
    product_id, 
    payment_month
        );
[0m16:54:22.258816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m16:54:22.258816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C59B830>]}
[0m16:54:22.258816 [info ] [Thread-1 (]: 5 of 14 OK created sql table model intermediate_joins.month_revenue ............ [[32mSUCCESS 1[0m in 0.63s]
[0m16:54:22.263174 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m16:54:22.263174 [debug] [Thread-1 (]: Began running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:54:22.263174 [info ] [Thread-1 (]: 6 of 14 START sql table model mart.revenue_lost_due_to_contraction_kpi ......... [RUN]
[0m16:54:22.263174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.month_revenue, now model.mini_project.revenue_lost_due_to_contraction_kpi)
[0m16:54:22.263174 [debug] [Thread-1 (]: Began compiling node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:54:22.263174 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:54:22.263174 [debug] [Thread-1 (]: Began executing node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:54:22.276671 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:54:22.278877 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:54:22.279930 [debug] [Thread-1 (]: On model.mini_project.revenue_lost_due_to_contraction_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.revenue_lost_due_to_contraction_kpi"} */
create or replace transient table mini_project.mart.revenue_lost_due_to_contraction_kpi
         as
        (WITH monthly_revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate_joins.join
    GROUP BY
        PAYMENT_MONTH
)
SELECT
    PAYMENT_MONTH
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY PAYMENT_MONTH) AS PREVIOUS_MONTH_REVENUE,
    CASE
        WHEN TOTAL_REVENUE<PREVIOUS_MONTH_REVENUE THEN (PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS REVENUE_LOST
FROM
    monthly_revenue
ORDER BY
    PAYMENT_MONTH;
[0m16:54:22.566502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb004c-3201-7db6-000c-3d6e0001fe62
[0m16:54:22.566502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 17 unexpected ';'.
[0m16:54:22.566502 [debug] [Thread-1 (]: Database Error in model revenue_lost_due_to_contraction_kpi (models\mart\revenue_lost_due_to_contraction_kpi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 17 unexpected ';'.
  compiled code at target\run\mini_project\models\mart\revenue_lost_due_to_contraction_kpi.sql
[0m16:54:22.566502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C5987D0>]}
[0m16:54:22.566502 [error] [Thread-1 (]: 6 of 14 ERROR creating sql table model mart.revenue_lost_due_to_contraction_kpi  [[31mERROR[0m in 0.30s]
[0m16:54:22.573862 [debug] [Thread-1 (]: Finished running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:54:22.573862 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m16:54:22.573862 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.revenue_lost_due_to_contraction_kpi' to be skipped because of status 'error'.  Reason: Database Error in model revenue_lost_due_to_contraction_kpi (models\mart\revenue_lost_due_to_contraction_kpi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 17 unexpected ';'.
  compiled code at target\run\mini_project\models\mart\revenue_lost_due_to_contraction_kpi.sql.
[0m16:54:22.573862 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate_joins.outer_join .................... [RUN]
[0m16:54:22.573862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.revenue_lost_due_to_contraction_kpi, now model.mini_project.outer_join)
[0m16:54:22.573862 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m16:54:22.573862 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m16:54:22.583667 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m16:54:22.586758 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m16:54:22.588726 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m16:54:22.589873 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:54:23.390888 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m16:54:23.390888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C55BC50>]}
[0m16:54:23.390888 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate_joins.outer_join ............... [[32mSUCCESS 1[0m in 0.82s]
[0m16:54:23.390888 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m16:54:23.390888 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_l3m
[0m16:54:23.390888 [info ] [Thread-1 (]: 8 of 14 START sql table model mart.kpi1_l3m .................................... [RUN]
[0m16:54:23.406768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.outer_join, now model.mini_project.kpi1_l3m)
[0m16:54:23.406768 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_l3m
[0m16:54:23.412094 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_l3m"
[0m16:54:23.412094 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_l3m
[0m16:54:23.416713 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_l3m"
[0m16:54:23.419636 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_l3m"
[0m16:54:23.420208 [debug] [Thread-1 (]: On model.mini_project.kpi1_l3m: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_l3m"} */
create or replace transient table mini_project.mart.kpi1_l3m
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-3,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
count(*)
FROM
FINAL
where RETENTION='NEW_CUSTOMER'
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:54:23.511078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb004c-3201-7e57-000c-3d6e00021d0a
[0m16:54:23.511078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m16:54:23.511078 [debug] [Thread-1 (]: Database Error in model kpi1_l3m (models\mart\kpi1_l3m.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\kpi1_l3m.sql
[0m16:54:23.511078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C459190>]}
[0m16:54:23.511078 [error] [Thread-1 (]: 8 of 14 ERROR creating sql table model mart.kpi1_l3m ........................... [[31mERROR[0m in 0.10s]
[0m16:54:23.511078 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_l3m
[0m16:54:23.511078 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m16:54:23.525310 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.kpi1_l3m' to be skipped because of status 'error'.  Reason: Database Error in model kpi1_l3m (models\mart\kpi1_l3m.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\kpi1_l3m.sql.
[0m16:54:23.525310 [info ] [Thread-1 (]: 9 of 14 START sql table model mart.kpi1_lm ..................................... [RUN]
[0m16:54:23.527046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_l3m, now model.mini_project.kpi1_lm)
[0m16:54:23.527046 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m16:54:23.532814 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m16:54:23.534653 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m16:54:23.534653 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m16:54:23.543203 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m16:54:23.543203 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace transient table mini_project.mart.kpi1_lm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:54:25.253146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m16:54:25.256677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C5D3A40>]}
[0m16:54:25.256677 [info ] [Thread-1 (]: 9 of 14 OK created sql table model mart.kpi1_lm ................................ [[32mSUCCESS 1[0m in 1.73s]
[0m16:54:25.256677 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m16:54:25.256677 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_ltm
[0m16:54:25.256677 [info ] [Thread-1 (]: 10 of 14 START sql table model mart.kpi1_ltm ................................... [RUN]
[0m16:54:25.259922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_lm, now model.mini_project.kpi1_ltm)
[0m16:54:25.259922 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_ltm
[0m16:54:25.264666 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_ltm"
[0m16:54:25.265733 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_ltm
[0m16:54:25.269446 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_ltm"
[0m16:54:25.271521 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_ltm"
[0m16:54:25.271521 [debug] [Thread-1 (]: On model.mini_project.kpi1_ltm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_ltm"} */
create or replace transient table mini_project.mart.kpi1_ltm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(year,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:54:26.439342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.176 seconds
[0m16:54:26.439342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C57D160>]}
[0m16:54:26.439342 [info ] [Thread-1 (]: 10 of 14 OK created sql table model mart.kpi1_ltm .............................. [[32mSUCCESS 1[0m in 1.18s]
[0m16:54:26.455421 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_ltm
[0m16:54:26.455421 [debug] [Thread-1 (]: Began running node model.mini_project.newlogos_kpi
[0m16:54:26.455421 [info ] [Thread-1 (]: 11 of 14 START sql table model mart.newlogos_kpi ............................... [RUN]
[0m16:54:26.457944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_ltm, now model.mini_project.newlogos_kpi)
[0m16:54:26.457944 [debug] [Thread-1 (]: Began compiling node model.mini_project.newlogos_kpi
[0m16:54:26.457944 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.newlogos_kpi"
[0m16:54:26.457944 [debug] [Thread-1 (]: Began executing node model.mini_project.newlogos_kpi
[0m16:54:26.457944 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.newlogos_kpi"
[0m16:54:26.471090 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.newlogos_kpi"
[0m16:54:26.471090 [debug] [Thread-1 (]: On model.mini_project.newlogos_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.newlogos_kpi"} */
create or replace transient table mini_project.mart.newlogos_kpi
         as
        (WITH FIRST_PURCHASE AS (
    SELECT 
        CUSTOMER_ID,
        MIN(PAYMENT_MONTH) AS FIRST_PURCHASE
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID
)
SELECT
    YEAR(FIRST_PURCHASE) AS FISCAL_YEAR,
    COUNT(CUSTOMER_ID) AS NEW_CUSTOMERS
FROM FIRST_PURCHASE
GROUP BY FISCAL_YEAR
        );
[0m16:54:26.968552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m16:54:26.968552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C6AE150>]}
[0m16:54:26.968552 [info ] [Thread-1 (]: 11 of 14 OK created sql table model mart.newlogos_kpi .......................... [[32mSUCCESS 1[0m in 0.51s]
[0m16:54:26.968552 [debug] [Thread-1 (]: Finished running node model.mini_project.newlogos_kpi
[0m16:54:26.968552 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m16:54:26.982261 [info ] [Thread-1 (]: 12 of 14 START sql table model mart.ranking_customers_based_on_revenue_kpi ..... [RUN]
[0m16:54:26.982261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.newlogos_kpi, now model.mini_project.ranking_customers_based_on_revenue_kpi)
[0m16:54:26.982261 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m16:54:26.988202 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m16:54:26.988202 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m16:54:26.992218 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m16:54:26.994226 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m16:54:26.994226 [debug] [Thread-1 (]: On model.mini_project.ranking_customers_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_customers_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_customers_based_on_revenue_kpi
         as
        (WITH CUSTOMER_REVENUE AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        ROUND(SUM(TOTAL_REVENUE),3) AS TOTAL_REVENUE_BY_CUSTOMER
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID,CUSTOMER_NAME
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_CUSTOMER DESC) AS RANK
FROM 
CUSTOMER_REVENUE
        );
[0m16:54:27.401717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m16:54:27.405674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C47B9E0>]}
[0m16:54:27.407684 [info ] [Thread-1 (]: 12 of 14 OK created sql table model mart.ranking_customers_based_on_revenue_kpi  [[32mSUCCESS 1[0m in 0.42s]
[0m16:54:27.407684 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m16:54:27.407684 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m16:54:27.407684 [info ] [Thread-1 (]: 13 of 14 START sql table model mart.ranking_products_based_on_revenue_kpi ...... [RUN]
[0m16:54:27.407684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_customers_based_on_revenue_kpi, now model.mini_project.ranking_products_based_on_revenue_kpi)
[0m16:54:27.407684 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_products_based_on_revenue_kpi
[0m16:54:27.413666 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m16:54:27.415673 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_products_based_on_revenue_kpi
[0m16:54:27.419510 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m16:54:27.421886 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m16:54:27.421886 [debug] [Thread-1 (]: On model.mini_project.ranking_products_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_products_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_products_based_on_revenue_kpi
         as
        (WITH PRODUCT_REVENUE AS (
    SELECT
        PRODUCT_ID,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE_BY_PRODUCT
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY PRODUCT_ID
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_PRODUCT DESC) AS RANK
FROM 
PRODUCT_REVENUE
        );
[0m16:54:27.870374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m16:54:27.870374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C47A810>]}
[0m16:54:27.870374 [info ] [Thread-1 (]: 13 of 14 OK created sql table model mart.ranking_products_based_on_revenue_kpi . [[32mSUCCESS 1[0m in 0.46s]
[0m16:54:27.870374 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m16:54:27.870374 [debug] [Thread-1 (]: Began running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m16:54:27.870374 [info ] [Thread-1 (]: 14 of 14 START sql table model mart.highest_cross_sell_and_product_churn_kpi ... [RUN]
[0m16:54:27.870374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_products_based_on_revenue_kpi, now model.mini_project.highest_cross_sell_and_product_churn_kpi)
[0m16:54:27.870374 [debug] [Thread-1 (]: Began compiling node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m16:54:27.887639 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m16:54:27.888651 [debug] [Thread-1 (]: Began executing node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m16:54:27.892497 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m16:54:27.893496 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m16:54:27.893496 [debug] [Thread-1 (]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.highest_cross_sell_and_product_churn_kpi"} */
create or replace transient table mini_project.mart.highest_cross_sell_and_product_churn_kpi
         as
        (select * from mini_project.mart.kpi1_lm
        );
[0m16:54:29.052778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.160 seconds
[0m16:54:29.052778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48be5f14-7b51-412d-849d-966a7acdb2b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0C406D80>]}
[0m16:54:29.052778 [info ] [Thread-1 (]: 14 of 14 OK created sql table model mart.highest_cross_sell_and_product_churn_kpi  [[32mSUCCESS 1[0m in 1.18s]
[0m16:54:29.052778 [debug] [Thread-1 (]: Finished running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m16:54:29.052778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:29.052778 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m16:54:29.052778 [debug] [MainThread]: On list_mini_project: Close
[0m16:54:29.175084 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m16:54:29.175084 [debug] [MainThread]: On list_mini_project_staging: Close
[0m16:54:29.268627 [debug] [MainThread]: Connection 'model.mini_project.highest_cross_sell_and_product_churn_kpi' was left open.
[0m16:54:29.268627 [debug] [MainThread]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: Close
[0m16:54:29.375757 [info ] [MainThread]: 
[0m16:54:29.377777 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 14.61 seconds (14.61s).
[0m16:54:29.377777 [debug] [MainThread]: Command end result
[0m16:54:29.417697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:54:29.418699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:54:29.418699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m16:54:29.418699 [info ] [MainThread]: 
[0m16:54:29.418699 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:54:29.418699 [info ] [MainThread]: 
[0m16:54:29.432381 [error] [MainThread]:   Database Error in model revenue_lost_due_to_contraction_kpi (models\mart\revenue_lost_due_to_contraction_kpi.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 17 unexpected ';'.
  compiled code at target\run\mini_project\models\mart\revenue_lost_due_to_contraction_kpi.sql
[0m16:54:29.433793 [info ] [MainThread]: 
[0m16:54:29.433793 [error] [MainThread]:   Database Error in model kpi1_l3m (models\mart\kpi1_l3m.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\kpi1_l3m.sql
[0m16:54:29.433793 [info ] [MainThread]: 
[0m16:54:29.433793 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 TOTAL=14
[0m16:54:29.438836 [debug] [MainThread]: Command `dbt run` failed at 16:54:29.437799 after 19.43 seconds
[0m16:54:29.438836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E079BE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E093F9AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E09C04590>]}
[0m16:54:29.439832 [debug] [MainThread]: Flushing usage events
[0m16:54:31.090126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:04.862262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120177D1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201AD71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201A5C21E0>]}


============================== 16:55:04.862262 | c3ebc03c-bfd4-48d5-a6cc-20a39818598d ==============================
[0m16:55:04.862262 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:55:04.878136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:05.429796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201B0167E0>]}
[0m16:55:05.509454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201A5EE1B0>]}
[0m16:55:05.509454 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:55:06.101881 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m16:55:06.225316 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:55:06.225316 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m16:55:06.227326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201D1FF650>]}
[0m16:55:07.924217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201D3023F0>]}
[0m16:55:08.033843 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:55:08.037607 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:55:08.071381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201D370590>]}
[0m16:55:08.071381 [info ] [MainThread]: Found 14 models, 3 sources, 476 macros
[0m16:55:08.071381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201D175B80>]}
[0m16:55:08.071381 [info ] [MainThread]: 
[0m16:55:08.071381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:08.071381 [info ] [MainThread]: 
[0m16:55:08.071381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:08.071381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m16:55:08.204171 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:55:08.204171 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:55:08.204171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:09.044128 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.831 seconds
[0m16:55:09.052150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m16:55:09.053155 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m16:55:09.053155 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m16:55:09.053155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:09.642070 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.578 seconds
[0m16:55:09.652302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m16:55:09.654324 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m16:55:09.654324 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m16:55:09.759392 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.103 seconds
[0m16:55:09.775153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_mart)
[0m16:55:09.780472 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m16:55:09.780472 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m16:55:09.889531 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.105 seconds
[0m16:55:09.896565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000120185C02F0>]}
[0m16:55:09.900575 [debug] [Thread-1 (]: Began running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:55:09.900575 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_lost_due_to_contraction_kpi .......... [RUN]
[0m16:55:09.901579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.revenue_lost_due_to_contraction_kpi'
[0m16:55:09.901579 [debug] [Thread-1 (]: Began compiling node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:55:09.912197 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:55:09.912197 [debug] [Thread-1 (]: Began executing node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:55:09.940864 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:55:09.956216 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m16:55:09.956216 [debug] [Thread-1 (]: On model.mini_project.revenue_lost_due_to_contraction_kpi: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.revenue_lost_due_to_contraction_kpi"} */
create or replace transient table mini_project.mart.revenue_lost_due_to_contraction_kpi
         as
        (WITH monthly_revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate_joins.join
    GROUP BY
        PAYMENT_MONTH
)
SELECT
    PAYMENT_MONTH
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY PAYMENT_MONTH) AS PREVIOUS_MONTH_REVENUE,
    CASE
        WHEN TOTAL_REVENUE<PREVIOUS_MONTH_REVENUE THEN (PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS REVENUE_LOST
FROM
    monthly_revenue
ORDER BY
    PAYMENT_MONTH
        );
[0m16:55:09.956216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:10.693297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m16:55:10.722619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3ebc03c-bfd4-48d5-a6cc-20a39818598d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201850A5D0>]}
[0m16:55:10.722619 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_lost_due_to_contraction_kpi ..... [[32mSUCCESS 1[0m in 0.82s]
[0m16:55:10.722619 [debug] [Thread-1 (]: Finished running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m16:55:10.722619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:10.722619 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m16:55:10.738393 [debug] [MainThread]: On list_mini_project: Close
[0m16:55:10.840529 [debug] [MainThread]: Connection 'list_mini_project_mart' was left open.
[0m16:55:10.840529 [debug] [MainThread]: On list_mini_project_mart: Close
[0m16:55:10.936326 [debug] [MainThread]: Connection 'model.mini_project.revenue_lost_due_to_contraction_kpi' was left open.
[0m16:55:10.936326 [debug] [MainThread]: On model.mini_project.revenue_lost_due_to_contraction_kpi: Close
[0m16:55:11.047418 [info ] [MainThread]: 
[0m16:55:11.047418 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m16:55:11.047418 [debug] [MainThread]: Command end result
[0m16:55:11.079767 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:55:11.079767 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:55:11.091986 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m16:55:11.091986 [info ] [MainThread]: 
[0m16:55:11.091986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:11.091986 [info ] [MainThread]: 
[0m16:55:11.091986 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:11.098545 [debug] [MainThread]: Command `cli run` succeeded at 16:55:11.091986 after 6.44 seconds
[0m16:55:11.098545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201AD71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201AEC3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001201AE1CCE0>]}
[0m16:55:11.098545 [debug] [MainThread]: Flushing usage events
[0m16:55:12.025608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:49.045836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020221A322A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020221D64170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020221DC3290>]}


============================== 16:55:49.045836 | 8589955b-d1d1-4122-8d13-0d6aa838e132 ==============================
[0m16:55:49.045836 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:55:49.045836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:49.594604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020222C50920>]}
[0m16:55:49.662909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002022226FC20>]}
[0m16:55:49.662909 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:55:50.131184 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m16:55:50.231454 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:55:50.231454 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m16:55:50.231454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020221DF3470>]}
[0m16:55:51.867003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202240BB260>]}
[0m16:55:52.001687 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:55:52.003697 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:55:52.033617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202222BC470>]}
[0m16:55:52.033617 [info ] [MainThread]: Found 14 models, 3 sources, 476 macros
[0m16:55:52.033617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202242EB3B0>]}
[0m16:55:52.040693 [info ] [MainThread]: 
[0m16:55:52.040693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:52.040693 [info ] [MainThread]: 
[0m16:55:52.042703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:52.042703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m16:55:52.167248 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m16:55:52.167248 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m16:55:52.167248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:54.151284 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.991 seconds
[0m16:55:54.168387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m16:55:54.183911 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m16:55:54.184426 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m16:55:54.184832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:54.533684 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.358 seconds
[0m16:55:54.533684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_mart)
[0m16:55:54.533684 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m16:55:54.533684 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m16:55:54.670349 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.124 seconds
[0m16:55:54.670349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m16:55:54.685302 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m16:55:54.687590 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m16:55:54.785916 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.104 seconds
[0m16:55:54.785916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202244D73B0>]}
[0m16:55:54.803902 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_l3m
[0m16:55:54.803902 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi1_l3m ..................................... [RUN]
[0m16:55:54.803902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1_l3m'
[0m16:55:54.803902 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_l3m
[0m16:55:54.824398 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_l3m"
[0m16:55:54.825397 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_l3m
[0m16:55:54.866824 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_l3m"
[0m16:55:54.866824 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_l3m"
[0m16:55:54.866824 [debug] [Thread-1 (]: On model.mini_project.kpi1_l3m: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_l3m"} */
create or replace transient table mini_project.mart.kpi1_l3m
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-3,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m16:55:54.866824 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:56.920023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.052 seconds
[0m16:55:56.936761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8589955b-d1d1-4122-8d13-0d6aa838e132', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021F66E3C0>]}
[0m16:55:56.936761 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi1_l3m ................................ [[32mSUCCESS 1[0m in 2.13s]
[0m16:55:56.951969 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_l3m
[0m16:55:56.954389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:56.954389 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m16:55:56.954389 [debug] [MainThread]: On list_mini_project: Close
[0m16:55:57.055626 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m16:55:57.055626 [debug] [MainThread]: On list_mini_project_staging: Close
[0m16:55:57.172911 [debug] [MainThread]: Connection 'model.mini_project.kpi1_l3m' was left open.
[0m16:55:57.173895 [debug] [MainThread]: On model.mini_project.kpi1_l3m: Close
[0m16:55:57.293735 [info ] [MainThread]: 
[0m16:55:57.295757 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m16:55:57.299802 [debug] [MainThread]: Command end result
[0m16:55:57.337284 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m16:55:57.337284 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m16:55:57.337284 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m16:55:57.337284 [info ] [MainThread]: 
[0m16:55:57.337284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:57.352435 [info ] [MainThread]: 
[0m16:55:57.352435 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:57.353963 [debug] [MainThread]: Command `cli run` succeeded at 16:55:57.353963 after 8.52 seconds
[0m16:55:57.354324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021F8FA150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202247A5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202240CD370>]}
[0m16:55:57.355326 [debug] [MainThread]: Flushing usage events
[0m16:55:58.425381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:19.200928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C84F2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC445640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC445670>]}


============================== 17:02:19.205834 | 45b4496f-382d-4001-a01b-5eb607a5296d ==============================
[0m17:02:19.205834 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:02:19.207842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:02:19.748498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CD16E000>]}
[0m17:02:19.821027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC322B10>]}
[0m17:02:19.821027 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:02:20.402041 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m17:02:20.502109 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:02:20.502109 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m17:02:20.502109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBFA3680>]}
[0m17:02:22.120592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CE479DF0>]}
[0m17:02:22.204059 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m17:02:22.220554 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m17:02:22.253881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC444FE0>]}
[0m17:02:22.253881 [info ] [MainThread]: Found 14 models, 3 sources, 476 macros
[0m17:02:22.253881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CE1D36E0>]}
[0m17:02:22.253881 [info ] [MainThread]: 
[0m17:02:22.253881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:22.253881 [info ] [MainThread]: 
[0m17:02:22.253881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:02:22.253881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m17:02:22.390502 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m17:02:22.392007 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m17:02:22.392007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:23.428269 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.037 seconds
[0m17:02:23.438863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m17:02:23.455268 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m17:02:23.455268 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m17:02:23.455268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:23.839236 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.385 seconds
[0m17:02:23.839236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m17:02:23.855487 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m17:02:23.855487 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m17:02:23.955571 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.102 seconds
[0m17:02:23.955571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_mart)
[0m17:02:23.955571 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m17:02:23.955571 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m17:02:24.038973 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.083 seconds
[0m17:02:24.038973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C98D0290>]}
[0m17:02:24.038973 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m17:02:24.053970 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.kpi1_lm ...................................... [RUN]
[0m17:02:24.055124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.kpi1_lm'
[0m17:02:24.055661 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m17:02:24.055661 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m17:02:24.055661 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m17:02:24.106301 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m17:02:24.107613 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m17:02:24.107613 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace transient table mini_project.mart.kpi1_lm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m17:02:24.107613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:26.091464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.982 seconds
[0m17:02:26.125273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45b4496f-382d-4001-a01b-5eb607a5296d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C981E360>]}
[0m17:02:26.125273 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.kpi1_lm ................................. [[32mSUCCESS 1[0m in 2.07s]
[0m17:02:26.125273 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m17:02:26.125273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:26.125273 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m17:02:26.125273 [debug] [MainThread]: On list_mini_project: Close
[0m17:02:26.241153 [debug] [MainThread]: Connection 'list_mini_project_mart' was left open.
[0m17:02:26.241153 [debug] [MainThread]: On list_mini_project_mart: Close
[0m17:02:26.341268 [debug] [MainThread]: Connection 'model.mini_project.kpi1_lm' was left open.
[0m17:02:26.341268 [debug] [MainThread]: On model.mini_project.kpi1_lm: Close
[0m17:02:26.461094 [info ] [MainThread]: 
[0m17:02:26.461094 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m17:02:26.461094 [debug] [MainThread]: Command end result
[0m17:02:26.495910 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m17:02:26.496875 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m17:02:26.507563 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m17:02:26.507563 [info ] [MainThread]: 
[0m17:02:26.508576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:26.509372 [info ] [MainThread]: 
[0m17:02:26.509372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:26.509372 [debug] [MainThread]: Command `cli run` succeeded at 17:02:26.509372 after 7.54 seconds
[0m17:02:26.509372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBB9F2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBF17B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C84F2BD0>]}
[0m17:02:26.509372 [debug] [MainThread]: Flushing usage events
[0m17:02:27.826823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:11.555747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E52B4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E2AA8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E52B53A0>]}


============================== 18:31:11.555747 | 17447ff1-4737-4d2f-be85-6b61e7e1ebbd ==============================
[0m18:31:11.555747 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:31:11.571578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:31:12.943750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E6030530>]}
[0m18:31:13.023548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E60326C0>]}
[0m18:31:13.023548 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m18:31:13.664169 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:31:13.780223 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:31:13.780223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E4DFB0B0>]}
[0m18:31:17.124126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E5FD7650>]}
[0m18:31:17.219278 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m18:31:17.246594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m18:31:17.300529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E74D2CF0>]}
[0m18:31:17.300529 [info ] [MainThread]: Found 14 models, 3 sources, 474 macros
[0m18:31:17.300529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E70F9460>]}
[0m18:31:17.300529 [info ] [MainThread]: 
[0m18:31:17.300529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:17.300529 [info ] [MainThread]: 
[0m18:31:17.312337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:17.321295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:31:21.438845 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:31:21.438845 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:31:21.438845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:22.594140 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.154 seconds
[0m18:31:22.598157 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:31:22.598157 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:31:22.978539 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.391 seconds
[0m18:31:22.994225 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:31:22.994225 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:31:23.083958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.086 seconds
[0m18:31:23.090500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m18:31:23.090500 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m18:31:23.090500 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m18:31:23.090500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:23.548089 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.456 seconds
[0m18:31:23.561781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_mart)
[0m18:31:23.561781 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:31:23.561781 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:31:23.674788 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.113 seconds
[0m18:31:23.674788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m18:31:23.690904 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:31:23.690904 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:31:23.802352 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.116 seconds
[0m18:31:23.821464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E74D21E0>]}
[0m18:31:23.826770 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m18:31:23.826770 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.customers ................................ [RUN]
[0m18:31:23.828770 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m18:31:23.828770 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m18:31:23.838811 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m18:31:23.840187 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m18:31:23.879602 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m18:31:23.881569 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m18:31:23.882599 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace transient table mini_project.staging.customers
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
    WHERE customer_id IS NOT NULL AND company IS NOT NULL AND customer_name IS NOT NULL
    ORDER BY customer_id
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
CUSTOMER_NAME,
COMPANY
FROM RAW_FORM
        );
[0m18:31:23.882599 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:24.838579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m18:31:24.894454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E477CB00>]}
[0m18:31:24.895470 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.customers ........................... [[32mSUCCESS 1[0m in 1.06s]
[0m18:31:24.896461 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m18:31:24.897494 [debug] [Thread-1 (]: Began running node model.mini_project.products
[0m18:31:24.898495 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.products ................................. [RUN]
[0m18:31:24.899462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customers, now model.mini_project.products)
[0m18:31:24.899462 [debug] [Thread-1 (]: Began compiling node model.mini_project.products
[0m18:31:24.903388 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.products"
[0m18:31:24.904857 [debug] [Thread-1 (]: Began executing node model.mini_project.products
[0m18:31:24.907943 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.products"
[0m18:31:24.910004 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.products"
[0m18:31:24.912016 [debug] [Thread-1 (]: On model.mini_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.products"} */
create or replace transient table mini_project.staging.products
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_PRODUCTS
    WHERE PRODUCT_ID IS NOT NULL AND PRODUCT_FAMILY IS NOT NULL AND PRODUCT_SUB_FAMILY IS NOT NULL
    ORDER BY PRODUCT_ID
)
SELECT
*
FROM
RAW_FORM
        );
[0m18:31:25.602756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m18:31:25.602756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7B342C0>]}
[0m18:31:25.618724 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.products ............................ [[32mSUCCESS 1[0m in 0.70s]
[0m18:31:25.618724 [debug] [Thread-1 (]: Finished running node model.mini_project.products
[0m18:31:25.618724 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m18:31:25.618724 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.transactions ............................. [RUN]
[0m18:31:25.618724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.products, now model.mini_project.transactions)
[0m18:31:25.618724 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m18:31:25.618724 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m18:31:25.618724 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m18:31:25.618724 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m18:31:25.618724 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m18:31:25.618724 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
    WHERE
    CUSTOMER_ID IS NOT NULL AND 
    PRODUCT_ID IS NOT NULL AND 
    PAYMENT_MONTH IS NOT NULL AND 
    REVENUE_TYPE IS NOT NULL AND 
    REVENUE IS NOT NULL AND 
    QUANTITY IS NOT NULL AND
    DIMENSION_1 IS NOT NULL AND
    DIMENSION_2 IS NOT NULL AND
    DIMENSION_3 IS NOT NULL AND
    DIMENSION_4 IS NOT NULL AND
    DIMENSION_5 IS NOT NULL AND
    DIMENSION_6 IS NOT NULL AND
    DIMENSION_7 IS NOT NULL AND
    DIMENSION_8 IS NOT NULL AND
    DIMENSION_9 IS NOT NULL AND
    DIMENSION_10 IS NOT NULL AND
    COMPANIES IS NOT NULL
    ORDER BY PAYMENT_MONTH
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
PRODUCT_ID,
TRY_TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
CAST(REVENUE_TYPE AS SMALLINT) AS REVENUE_TYPE,
CAST(REVENUE AS FLOAT) AS REVENUE,
CAST(QUANTITY AS SMALLINT) AS QUANTITY,
COMPANIES
FROM RAW_FORM
        );
[0m18:31:26.324941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m18:31:26.333035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7AF0800>]}
[0m18:31:26.335058 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.transactions ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m18:31:26.337081 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m18:31:26.337081 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m18:31:26.344797 [info ] [Thread-1 (]: 4 of 14 START sql table model intermediate_joins.join .......................... [RUN]
[0m18:31:26.348265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.transactions, now model.mini_project.join)
[0m18:31:26.349264 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m18:31:26.354992 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m18:31:26.357382 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m18:31:26.361527 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m18:31:26.364490 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m18:31:26.365495 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
where REVENUE_TYPE=1
order by customer_id
        );
[0m18:31:27.218916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m18:31:27.229754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7B43170>]}
[0m18:31:27.231765 [info ] [Thread-1 (]: 4 of 14 OK created sql table model intermediate_joins.join ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m18:31:27.231765 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m18:31:27.234648 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m18:31:27.234648 [info ] [Thread-1 (]: 5 of 14 START sql table model intermediate_joins.month_revenue ................. [RUN]
[0m18:31:27.234648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.join, now model.mini_project.month_revenue)
[0m18:31:27.234648 [debug] [Thread-1 (]: Began compiling node model.mini_project.month_revenue
[0m18:31:27.234648 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.month_revenue"
[0m18:31:27.234648 [debug] [Thread-1 (]: Began executing node model.mini_project.month_revenue
[0m18:31:27.234648 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.month_revenue"
[0m18:31:27.234648 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.month_revenue"
[0m18:31:27.234648 [debug] [Thread-1 (]: On model.mini_project.month_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.month_revenue"} */
create or replace transient table mini_project.intermediate_joins.month_revenue
         as
        (SELECT 
    customer_id,
    product_id,
    payment_month,
    SUM(revenue) AS total_revenue
FROM 
    mini_project.intermediate_joins.join
GROUP BY 
    customer_id, 
    product_id,
    payment_month
ORDER BY 
    customer_id, 
    product_id, 
    payment_month
        );
[0m18:31:27.785043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m18:31:27.798169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7BFAAB0>]}
[0m18:31:27.800179 [info ] [Thread-1 (]: 5 of 14 OK created sql table model intermediate_joins.month_revenue ............ [[32mSUCCESS 1[0m in 0.56s]
[0m18:31:27.800179 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m18:31:27.800179 [debug] [Thread-1 (]: Began running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m18:31:27.800179 [info ] [Thread-1 (]: 6 of 14 START sql table model mart.revenue_lost_due_to_contraction_kpi ......... [RUN]
[0m18:31:27.800179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.month_revenue, now model.mini_project.revenue_lost_due_to_contraction_kpi)
[0m18:31:27.800179 [debug] [Thread-1 (]: Began compiling node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m18:31:27.808108 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m18:31:27.808108 [debug] [Thread-1 (]: Began executing node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m18:31:27.808108 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m18:31:27.817686 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m18:31:27.817686 [debug] [Thread-1 (]: On model.mini_project.revenue_lost_due_to_contraction_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.revenue_lost_due_to_contraction_kpi"} */
create or replace transient table mini_project.mart.revenue_lost_due_to_contraction_kpi
         as
        (WITH monthly_revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate_joins.join
    GROUP BY
        PAYMENT_MONTH
)
SELECT
    PAYMENT_MONTH
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY PAYMENT_MONTH) AS PREVIOUS_MONTH_REVENUE,
    CASE
        WHEN TOTAL_REVENUE<PREVIOUS_MONTH_REVENUE THEN ABS(PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS REVENUE_LOST
FROM
    monthly_revenue
ORDER BY
    PAYMENT_MONTH
        );
[0m18:31:28.378285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m18:31:28.378285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7C39EE0>]}
[0m18:31:28.378285 [info ] [Thread-1 (]: 6 of 14 OK created sql table model mart.revenue_lost_due_to_contraction_kpi .... [[32mSUCCESS 1[0m in 0.58s]
[0m18:31:28.378285 [debug] [Thread-1 (]: Finished running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m18:31:28.378285 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m18:31:28.378285 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate_joins.outer_join .................... [RUN]
[0m18:31:28.378285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.revenue_lost_due_to_contraction_kpi, now model.mini_project.outer_join)
[0m18:31:28.394213 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m18:31:28.394213 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m18:31:28.394213 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m18:31:28.394213 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m18:31:28.394213 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m18:31:28.394213 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by CUSTOMER_ID,PAYMENT_MONTH
        );
[0m18:31:29.160943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m18:31:29.165201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7BF9190>]}
[0m18:31:29.165201 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate_joins.outer_join ............... [[32mSUCCESS 1[0m in 0.79s]
[0m18:31:29.165201 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m18:31:29.176686 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_l3m
[0m18:31:29.176686 [info ] [Thread-1 (]: 8 of 14 START sql table model mart.kpi1_l3m .................................... [RUN]
[0m18:31:29.176686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.outer_join, now model.mini_project.kpi1_l3m)
[0m18:31:29.184053 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_l3m
[0m18:31:29.195691 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_l3m"
[0m18:31:29.198445 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_l3m
[0m18:31:29.203735 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_l3m"
[0m18:31:29.207851 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_l3m"
[0m18:31:29.207851 [debug] [Thread-1 (]: On model.mini_project.kpi1_l3m: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_l3m"} */
create or replace transient table mini_project.mart.kpi1_l3m
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-3,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m18:31:30.984950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.781 seconds
[0m18:31:30.984950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7A64BC0>]}
[0m18:31:30.984950 [info ] [Thread-1 (]: 8 of 14 OK created sql table model mart.kpi1_l3m ............................... [[32mSUCCESS 1[0m in 1.81s]
[0m18:31:30.984950 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_l3m
[0m18:31:30.984950 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m18:31:30.984950 [info ] [Thread-1 (]: 9 of 14 START sql table model mart.kpi1_lm ..................................... [RUN]
[0m18:31:30.984950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_l3m, now model.mini_project.kpi1_lm)
[0m18:31:30.984950 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m18:31:31.000707 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m18:31:31.003583 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m18:31:31.006492 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m18:31:31.011074 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m18:31:31.011074 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace transient table mini_project.mart.kpi1_lm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m18:31:32.813704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.815 seconds
[0m18:31:32.830829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7B1CC20>]}
[0m18:31:32.830829 [info ] [Thread-1 (]: 9 of 14 OK created sql table model mart.kpi1_lm ................................ [[32mSUCCESS 1[0m in 1.85s]
[0m18:31:32.833752 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m18:31:32.834752 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_ltm
[0m18:31:32.835752 [info ] [Thread-1 (]: 10 of 14 START sql table model mart.kpi1_ltm ................................... [RUN]
[0m18:31:32.836710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_lm, now model.mini_project.kpi1_ltm)
[0m18:31:32.837752 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_ltm
[0m18:31:32.843751 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_ltm"
[0m18:31:32.845712 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_ltm
[0m18:31:32.851853 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_ltm"
[0m18:31:32.855874 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_ltm"
[0m18:31:32.855874 [debug] [Thread-1 (]: On model.mini_project.kpi1_ltm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_ltm"} */
create or replace transient table mini_project.mart.kpi1_ltm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(year,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m18:31:33.966339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m18:31:33.966339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7AF1D00>]}
[0m18:31:33.966339 [info ] [Thread-1 (]: 10 of 14 OK created sql table model mart.kpi1_ltm .............................. [[32mSUCCESS 1[0m in 1.13s]
[0m18:31:33.966339 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_ltm
[0m18:31:33.966339 [debug] [Thread-1 (]: Began running node model.mini_project.newlogos_kpi
[0m18:31:33.966339 [info ] [Thread-1 (]: 11 of 14 START sql table model mart.newlogos_kpi ............................... [RUN]
[0m18:31:33.980658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_ltm, now model.mini_project.newlogos_kpi)
[0m18:31:33.980658 [debug] [Thread-1 (]: Began compiling node model.mini_project.newlogos_kpi
[0m18:31:33.980658 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.newlogos_kpi"
[0m18:31:33.980658 [debug] [Thread-1 (]: Began executing node model.mini_project.newlogos_kpi
[0m18:31:33.980658 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.newlogos_kpi"
[0m18:31:33.980658 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.newlogos_kpi"
[0m18:31:33.980658 [debug] [Thread-1 (]: On model.mini_project.newlogos_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.newlogos_kpi"} */
create or replace transient table mini_project.mart.newlogos_kpi
         as
        (WITH FIRST_PURCHASE AS (
    SELECT 
        CUSTOMER_ID,
        MIN(PAYMENT_MONTH) AS FIRST_PURCHASE
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID
)
SELECT
    YEAR(FIRST_PURCHASE) AS FISCAL_YEAR,
    COUNT(CUSTOMER_ID) AS NEW_CUSTOMERS
FROM FIRST_PURCHASE
GROUP BY FISCAL_YEAR
        );
[0m18:31:34.381979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m18:31:34.381979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7C70F20>]}
[0m18:31:34.391912 [info ] [Thread-1 (]: 11 of 14 OK created sql table model mart.newlogos_kpi .......................... [[32mSUCCESS 1[0m in 0.42s]
[0m18:31:34.391912 [debug] [Thread-1 (]: Finished running node model.mini_project.newlogos_kpi
[0m18:31:34.391912 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m18:31:34.391912 [info ] [Thread-1 (]: 12 of 14 START sql table model mart.ranking_customers_based_on_revenue_kpi ..... [RUN]
[0m18:31:34.391912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.newlogos_kpi, now model.mini_project.ranking_customers_based_on_revenue_kpi)
[0m18:31:34.399477 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m18:31:34.405703 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m18:31:34.407670 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m18:31:34.413700 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m18:31:34.416694 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m18:31:34.417695 [debug] [Thread-1 (]: On model.mini_project.ranking_customers_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_customers_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_customers_based_on_revenue_kpi
         as
        (WITH CUSTOMER_REVENUE AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        ROUND(SUM(TOTAL_REVENUE),3) AS TOTAL_REVENUE_BY_CUSTOMER
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID,CUSTOMER_NAME
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_CUSTOMER DESC) AS RANK
FROM 
CUSTOMER_REVENUE
        );
[0m18:31:34.985520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m18:31:34.985520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7C71670>]}
[0m18:31:34.985520 [info ] [Thread-1 (]: 12 of 14 OK created sql table model mart.ranking_customers_based_on_revenue_kpi  [[32mSUCCESS 1[0m in 0.59s]
[0m18:31:34.985520 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m18:31:35.000476 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m18:31:35.000476 [info ] [Thread-1 (]: 13 of 14 START sql table model mart.ranking_products_based_on_revenue_kpi ...... [RUN]
[0m18:31:35.000476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_customers_based_on_revenue_kpi, now model.mini_project.ranking_products_based_on_revenue_kpi)
[0m18:31:35.000476 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_products_based_on_revenue_kpi
[0m18:31:35.000476 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m18:31:35.000476 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_products_based_on_revenue_kpi
[0m18:31:35.000476 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m18:31:35.000476 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m18:31:35.000476 [debug] [Thread-1 (]: On model.mini_project.ranking_products_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_products_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_products_based_on_revenue_kpi
         as
        (WITH PRODUCT_REVENUE AS (
    SELECT
        PRODUCT_ID,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE_BY_PRODUCT
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY PRODUCT_ID
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_PRODUCT DESC) AS RANK
FROM 
PRODUCT_REVENUE
        );
[0m18:31:35.506245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m18:31:35.506245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7C18C20>]}
[0m18:31:35.506245 [info ] [Thread-1 (]: 13 of 14 OK created sql table model mart.ranking_products_based_on_revenue_kpi . [[32mSUCCESS 1[0m in 0.51s]
[0m18:31:35.506245 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m18:31:35.506245 [debug] [Thread-1 (]: Began running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:31:35.506245 [info ] [Thread-1 (]: 14 of 14 START sql table model mart.highest_cross_sell_and_product_churn_kpi ... [RUN]
[0m18:31:35.506245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_products_based_on_revenue_kpi, now model.mini_project.highest_cross_sell_and_product_churn_kpi)
[0m18:31:35.506245 [debug] [Thread-1 (]: Began compiling node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:31:35.518839 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:31:35.520656 [debug] [Thread-1 (]: Began executing node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:31:35.523859 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:31:35.528754 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:31:35.529799 [debug] [Thread-1 (]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.highest_cross_sell_and_product_churn_kpi"} */
create or replace transient table mini_project.mart.highest_cross_sell_and_product_churn_kpi
         as
        (WITH BASE AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH
),BASE2 AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH
), FINAL AS (
    SELECT 
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_MONTH,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
    FROM BASE LEFT JOIN BASE2 ON BASE.CUSTOMER_ID=BASE2.CUSTOMER_ID AND BASE.PREVIOUS_MONTH=BASE2.PAYMENT_MONTH
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH
),FINAL2 AS (
SELECT
    CUSTOMER_ID,
    PAYMENT_MONTH,
    NO_OF_PRODUCTS,
    TOTAL_REVENUE,
    PREVIOUS_MONTH,
    PREVIOUS_MONTH_REVENUE,
    NO_OF_PRODUCTS_PAST_MONTH,
    CASE
        WHEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)>0 THEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)
        ELSE 0
    END AS CROSS_SELL_IN_PRODUCTS,
    CASE
        WHEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)>0 THEN ABS(TOTAL_REVENUE-PREVIOUS_MONTH_REVENUE) 
        ELSE 0 
    END AS CROSS_SELL_IN_REVENUE,
    CASE
        WHEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)>0 THEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)
        ELSE 0
    END AS PRODUCT_CHURN,
    CASE
        WHEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)>0 THEN ABS(PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS PRODUCT_CHURN_IN_REVENUE
FROM 
FINAL
ORDER BY CROSS_SELL_IN_REVENUE DESC,PRODUCT_CHURN_IN_REVENUE DESC
)SELECT SUM(PRODUCT_CHURN_IN_REVENUE) FROM FINAL2
        );
[0m18:31:35.874496 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ad-3201-7e56-000c-3d6e00026526
[0m18:31:35.874496 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m18:31:35.890417 [debug] [Thread-1 (]: Database Error in model highest_cross_sell_and_product_churn_kpi (models\mart\highest_cross_sell_and_product_churn_kpi.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\highest_cross_sell_and_product_churn_kpi.sql
[0m18:31:35.890417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17447ff1-4737-4d2f-be85-6b61e7e1ebbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E7A0E3C0>]}
[0m18:31:35.890417 [error] [Thread-1 (]: 14 of 14 ERROR creating sql table model mart.highest_cross_sell_and_product_churn_kpi  [[31mERROR[0m in 0.38s]
[0m18:31:35.890417 [debug] [Thread-1 (]: Finished running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:31:35.890417 [debug] [Thread-4 (]: Marking all children of 'model.mini_project.highest_cross_sell_and_product_churn_kpi' to be skipped because of status 'error'.  Reason: Database Error in model highest_cross_sell_and_product_churn_kpi (models\mart\highest_cross_sell_and_product_churn_kpi.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\highest_cross_sell_and_product_churn_kpi.sql.
[0m18:31:35.890417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:35.890417 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:31:35.890417 [debug] [MainThread]: On list_mini_project: Close
[0m18:31:36.004364 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m18:31:36.004364 [debug] [MainThread]: On list_mini_project_staging: Close
[0m18:31:36.100089 [debug] [MainThread]: Connection 'model.mini_project.highest_cross_sell_and_product_churn_kpi' was left open.
[0m18:31:36.100089 [debug] [MainThread]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: Close
[0m18:31:36.197373 [info ] [MainThread]: 
[0m18:31:36.197373 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 18.89 seconds (18.89s).
[0m18:31:36.197373 [debug] [MainThread]: Command end result
[0m18:31:36.238843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m18:31:36.238843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m18:31:36.253540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m18:31:36.253930 [info ] [MainThread]: 
[0m18:31:36.253930 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:31:36.253930 [info ] [MainThread]: 
[0m18:31:36.253930 [error] [MainThread]:   Database Error in model highest_cross_sell_and_product_churn_kpi (models\mart\highest_cross_sell_and_product_churn_kpi.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\mini_project\models\mart\highest_cross_sell_and_product_churn_kpi.sql
[0m18:31:36.253930 [info ] [MainThread]: 
[0m18:31:36.253930 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m18:31:36.253930 [debug] [MainThread]: Command `dbt run` failed at 18:31:36.253930 after 24.97 seconds
[0m18:31:36.253930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E5023590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E4FFF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7E4E298E0>]}
[0m18:31:36.261497 [debug] [MainThread]: Flushing usage events
[0m18:31:37.534886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:04.514646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681C24A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681CC1F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681CC1C140>]}


============================== 18:32:04.526585 | 0e2b6204-580c-4577-b789-f400ef810b0c ==============================
[0m18:32:04.526585 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:32:04.526585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\AdithyaKasturi\\mini_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:05.933213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681EFA2FF0>]}
[0m18:32:06.016091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681FB667B0>]}
[0m18:32:06.016091 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:32:06.616075 [debug] [MainThread]: checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, vars: {}, profile: , target: dev, version: 1.9.0
[0m18:32:06.716864 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:32:06.716864 [debug] [MainThread]: previous checksum: ecedd675605f1ce170fa0d6bcc1fa794ad0ab77b0bd7aa7326be16dd9b7c5032, current checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff
[0m18:32:06.716864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681FD1BD10>]}
[0m18:32:08.385119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820DEF290>]}
[0m18:32:08.468531 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m18:32:08.499166 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m18:32:08.552028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168211EA960>]}
[0m18:32:08.552028 [info ] [MainThread]: Found 14 models, 3 sources, 476 macros
[0m18:32:08.554037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168211F52B0>]}
[0m18:32:08.555047 [info ] [MainThread]: 
[0m18:32:08.555047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:08.557067 [info ] [MainThread]: 
[0m18:32:08.557576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:08.557576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:32:10.318321 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:32:10.318321 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:32:10.318321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:11.212940 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.898 seconds
[0m18:32:11.221290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m18:32:11.238108 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:32:11.238108 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:32:11.238108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:11.721201 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.481 seconds
[0m18:32:11.721692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m18:32:11.729064 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:32:11.729064 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:32:11.813238 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.085 seconds
[0m18:32:11.818021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate_joins)
[0m18:32:11.821706 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m18:32:11.821706 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m18:32:11.905364 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.083 seconds
[0m18:32:11.905364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001682113AE70>]}
[0m18:32:11.905364 [debug] [Thread-1 (]: Began running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:32:11.905364 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell_and_product_churn_kpi ..... [RUN]
[0m18:32:11.913161 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.highest_cross_sell_and_product_churn_kpi'
[0m18:32:11.913161 [debug] [Thread-1 (]: Began compiling node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:32:11.925363 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:32:11.927366 [debug] [Thread-1 (]: Began executing node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:32:11.971953 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:32:11.975974 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m18:32:11.975974 [debug] [Thread-1 (]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.highest_cross_sell_and_product_churn_kpi"} */
create or replace transient table mini_project.mart.highest_cross_sell_and_product_churn_kpi
         as
        (WITH BASE AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH
),BASE2 AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH
), FINAL AS (
    SELECT 
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_MONTH,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
    FROM BASE LEFT JOIN BASE2 ON BASE.CUSTOMER_ID=BASE2.CUSTOMER_ID AND BASE.PREVIOUS_MONTH=BASE2.PAYMENT_MONTH
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH
),FINAL2 AS (
SELECT
    CUSTOMER_ID,
    PAYMENT_MONTH,
    NO_OF_PRODUCTS,
    TOTAL_REVENUE,
    PREVIOUS_MONTH,
    PREVIOUS_MONTH_REVENUE,
    NO_OF_PRODUCTS_PAST_MONTH,
    CASE
        WHEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)>0 THEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)
        ELSE 0
    END AS CROSS_SELL_IN_PRODUCTS,
    CASE
        WHEN (NO_OF_PRODUCTS-NO_OF_PRODUCTS_PAST_MONTH)>0 THEN ABS(TOTAL_REVENUE-PREVIOUS_MONTH_REVENUE) 
        ELSE 0 
    END AS CROSS_SELL_IN_REVENUE,
    CASE
        WHEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)>0 THEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)
        ELSE 0
    END AS PRODUCT_CHURN,
    CASE
        WHEN (NO_OF_PRODUCTS_PAST_MONTH-NO_OF_PRODUCTS)>0 THEN ABS(PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS PRODUCT_CHURN_IN_REVENUE
FROM 
FINAL
ORDER BY CROSS_SELL_IN_REVENUE DESC,PRODUCT_CHURN_IN_REVENUE DESC
)SELECT * FROM FINAL2
        );
[0m18:32:11.978623 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:13.106534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.139 seconds
[0m18:32:13.139766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e2b6204-580c-4577-b789-f400ef810b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681C34E480>]}
[0m18:32:13.139766 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.highest_cross_sell_and_product_churn_kpi  [[32mSUCCESS 1[0m in 1.23s]
[0m18:32:13.153123 [debug] [Thread-1 (]: Finished running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m18:32:13.153123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:13.155177 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:32:13.155930 [debug] [MainThread]: On list_mini_project: Close
[0m18:32:13.423447 [debug] [MainThread]: Connection 'list_mini_project_intermediate_joins' was left open.
[0m18:32:13.423447 [debug] [MainThread]: On list_mini_project_intermediate_joins: Close
[0m18:32:13.523604 [debug] [MainThread]: Connection 'model.mini_project.highest_cross_sell_and_product_churn_kpi' was left open.
[0m18:32:13.534033 [debug] [MainThread]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: Close
[0m18:32:13.666607 [info ] [MainThread]: 
[0m18:32:13.666607 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m18:32:13.666607 [debug] [MainThread]: Command end result
[0m18:32:13.697283 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m18:32:13.702508 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m18:32:13.714059 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m18:32:13.714059 [info ] [MainThread]: 
[0m18:32:13.716067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:13.716067 [info ] [MainThread]: 
[0m18:32:13.716067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:32:13.716067 [debug] [MainThread]: Command `cli run` succeeded at 18:32:13.716067 after 9.42 seconds
[0m18:32:13.716067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681C24A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001681FC93AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168211F78C0>]}
[0m18:32:13.716067 [debug] [MainThread]: Flushing usage events
[0m18:32:14.724860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:47.379816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D13559640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D135597C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D135594F0>]}


============================== 19:30:47.379816 | 795cc55e-6725-47cc-8e28-3f57416f191e ==============================
[0m19:30:47.379816 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:30:47.379816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\AdithyaKasturi\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\AdithyaKasturi\\mini_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:30:49.243416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D135855B0>]}
[0m19:30:49.313179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D14257980>]}
[0m19:30:49.313179 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:30:49.945734 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:30:50.040869 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:30:50.040869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D1568AFF0>]}
[0m19:30:52.711338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D155C4E30>]}
[0m19:30:52.802913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m19:30:52.842456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m19:30:52.913960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D155C6960>]}
[0m19:30:52.913960 [info ] [MainThread]: Found 15 models, 3 sources, 474 macros
[0m19:30:52.916648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15815CD0>]}
[0m19:30:52.917499 [info ] [MainThread]: 
[0m19:30:52.917499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:52.917499 [info ] [MainThread]: 
[0m19:30:52.917499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:52.935442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:30:54.644936 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:30:54.644936 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:30:54.644936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:56.799714 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.150 seconds
[0m19:30:56.806188 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:30:56.806188 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:30:56.940840 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.143 seconds
[0m19:30:56.954619 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:30:56.954619 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:30:57.083001 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.130 seconds
[0m19:30:57.098666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate_joins'
[0m19:30:57.098666 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate_joins"
[0m19:30:57.098666 [debug] [ThreadPool]: On list_mini_project_intermediate_joins: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_intermediate_joins"} */
show objects in mini_project.intermediate_joins limit 10000;
[0m19:30:57.098666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:57.628067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.516 seconds
[0m19:30:57.630075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate_joins, now list_mini_project_staging)
[0m19:30:57.630075 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:30:57.630075 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:30:57.762871 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.135 seconds
[0m19:30:57.762871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_mart)
[0m19:30:57.780503 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:30:57.780503 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:30:57.938418 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.158 seconds
[0m19:30:57.938418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15822B70>]}
[0m19:30:57.954128 [debug] [Thread-1 (]: Began running node model.mini_project.customers
[0m19:30:57.954128 [info ] [Thread-1 (]: 1 of 14 START sql table model staging.customers ................................ [RUN]
[0m19:30:57.954128 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.mini_project.customers'
[0m19:30:57.954128 [debug] [Thread-1 (]: Began compiling node model.mini_project.customers
[0m19:30:57.954128 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.customers"
[0m19:30:57.969927 [debug] [Thread-1 (]: Began executing node model.mini_project.customers
[0m19:30:58.001839 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.customers"
[0m19:30:58.001839 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.customers"
[0m19:30:58.001839 [debug] [Thread-1 (]: On model.mini_project.customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.customers"} */
create or replace transient table mini_project.staging.customers
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_CUSTOMERS
    WHERE customer_id IS NOT NULL AND company IS NOT NULL AND customer_name IS NOT NULL
    ORDER BY customer_id
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
CUSTOMER_NAME,
COMPANY
FROM RAW_FORM
        );
[0m19:30:58.001839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:59.182206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.165 seconds
[0m19:30:59.213947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D12A3CC50>]}
[0m19:30:59.213947 [info ] [Thread-1 (]: 1 of 14 OK created sql table model staging.customers ........................... [[32mSUCCESS 1[0m in 1.24s]
[0m19:30:59.213947 [debug] [Thread-1 (]: Finished running node model.mini_project.customers
[0m19:30:59.213947 [debug] [Thread-1 (]: Began running node model.mini_project.products
[0m19:30:59.213947 [info ] [Thread-1 (]: 2 of 14 START sql table model staging.products ................................. [RUN]
[0m19:30:59.213947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.customers, now model.mini_project.products)
[0m19:30:59.213947 [debug] [Thread-1 (]: Began compiling node model.mini_project.products
[0m19:30:59.221819 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.products"
[0m19:30:59.230249 [debug] [Thread-1 (]: Began executing node model.mini_project.products
[0m19:30:59.230249 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.products"
[0m19:30:59.230249 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.products"
[0m19:30:59.230249 [debug] [Thread-1 (]: On model.mini_project.products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.products"} */
create or replace transient table mini_project.staging.products
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_PRODUCTS
    WHERE PRODUCT_ID IS NOT NULL AND PRODUCT_FAMILY IS NOT NULL AND PRODUCT_SUB_FAMILY IS NOT NULL
    ORDER BY PRODUCT_ID
)
SELECT
*
FROM
RAW_FORM
        );
[0m19:30:59.920446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m19:30:59.920446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E3B740>]}
[0m19:30:59.920446 [info ] [Thread-1 (]: 2 of 14 OK created sql table model staging.products ............................ [[32mSUCCESS 1[0m in 0.71s]
[0m19:30:59.920446 [debug] [Thread-1 (]: Finished running node model.mini_project.products
[0m19:30:59.920446 [debug] [Thread-1 (]: Began running node model.mini_project.transactions
[0m19:30:59.936611 [info ] [Thread-1 (]: 3 of 14 START sql table model staging.transactions ............................. [RUN]
[0m19:30:59.936611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.products, now model.mini_project.transactions)
[0m19:30:59.936611 [debug] [Thread-1 (]: Began compiling node model.mini_project.transactions
[0m19:30:59.936611 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.transactions"
[0m19:30:59.936611 [debug] [Thread-1 (]: Began executing node model.mini_project.transactions
[0m19:30:59.936611 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.transactions"
[0m19:30:59.952588 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.transactions"
[0m19:30:59.952588 [debug] [Thread-1 (]: On model.mini_project.transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.transactions"} */
create or replace transient table mini_project.staging.transactions
         as
        (WITH RAW_FORM AS (
    SELECT
    DISTINCT * 
    FROM mini_project.raw.ONLINE_FOOD_DELIVERY_TRANSACTIONS
    WHERE
    CUSTOMER_ID IS NOT NULL AND 
    PRODUCT_ID IS NOT NULL AND 
    PAYMENT_MONTH IS NOT NULL AND 
    REVENUE_TYPE IS NOT NULL AND 
    REVENUE IS NOT NULL AND 
    QUANTITY IS NOT NULL AND
    DIMENSION_1 IS NOT NULL AND
    DIMENSION_2 IS NOT NULL AND
    DIMENSION_3 IS NOT NULL AND
    DIMENSION_4 IS NOT NULL AND
    DIMENSION_5 IS NOT NULL AND
    DIMENSION_6 IS NOT NULL AND
    DIMENSION_7 IS NOT NULL AND
    DIMENSION_8 IS NOT NULL AND
    DIMENSION_9 IS NOT NULL AND
    DIMENSION_10 IS NOT NULL AND
    COMPANIES IS NOT NULL
    ORDER BY PAYMENT_MONTH
)
SELECT
CAST(CUSTOMER_ID AS INT) AS CUSTOMER_ID,
PRODUCT_ID,
TRY_TO_DATE(PAYMENT_MONTH, 'MM-DD-YYYY') AS PAYMENT_MONTH,
CAST(REVENUE_TYPE AS SMALLINT) AS REVENUE_TYPE,
CAST(REVENUE AS FLOAT) AS REVENUE,
CAST(QUANTITY AS SMALLINT) AS QUANTITY,
COMPANIES
FROM RAW_FORM
        );
[0m19:31:00.792278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m19:31:00.802101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15F165D0>]}
[0m19:31:00.802101 [info ] [Thread-1 (]: 3 of 14 OK created sql table model staging.transactions ........................ [[32mSUCCESS 1[0m in 0.86s]
[0m19:31:00.802101 [debug] [Thread-1 (]: Finished running node model.mini_project.transactions
[0m19:31:00.802101 [debug] [Thread-1 (]: Began running node model.mini_project.join
[0m19:31:00.802101 [info ] [Thread-1 (]: 4 of 14 START sql table model intermediate_joins.join .......................... [RUN]
[0m19:31:00.802101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.transactions, now model.mini_project.join)
[0m19:31:00.802101 [debug] [Thread-1 (]: Began compiling node model.mini_project.join
[0m19:31:00.808453 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.join"
[0m19:31:00.808453 [debug] [Thread-1 (]: Began executing node model.mini_project.join
[0m19:31:00.808453 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.join"
[0m19:31:00.827130 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.join"
[0m19:31:00.827130 [debug] [Thread-1 (]: On model.mini_project.join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.join"} */
create or replace transient table mini_project.intermediate_joins.join
         as
        (WITH customer_and_transaction_joins AS (
    SELECT
    customers.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    transactions.COMPANIES
    FROM 
    mini_project.staging.transactions AS transactions
    INNER JOIN
    mini_project.staging.customers AS customers
    ON
    transactions.CUSTOMER_ID = customers.CUSTOMER_ID
), product_and_transactions_join AS(
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    products.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    DATE(PAYMENT_MONTH, 'YYYY-DD-MM') AS PAYMENT_MONTH,
    REVENUE_TYPE,
    REVENUE,
    QUANTITY,
    COMPANIES
    FROM
    customer_and_transaction_joins
    INNER JOIN
    mini_project.staging.products AS products 
    ON customer_and_transaction_joins.PRODUCT_ID = products.PRODUCT_ID
)
SELECT * FROM product_and_transactions_join
where REVENUE_TYPE=1
order by customer_id
        );
[0m19:31:01.877030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.055 seconds
[0m19:31:01.877030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E067B0>]}
[0m19:31:01.892660 [info ] [Thread-1 (]: 4 of 14 OK created sql table model intermediate_joins.join ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m19:31:01.894048 [debug] [Thread-1 (]: Finished running node model.mini_project.join
[0m19:31:01.894048 [debug] [Thread-1 (]: Began running node model.mini_project.month_revenue
[0m19:31:01.894048 [info ] [Thread-1 (]: 5 of 14 START sql table model intermediate_joins.month_revenue ................. [RUN]
[0m19:31:01.894048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.join, now model.mini_project.month_revenue)
[0m19:31:01.906869 [debug] [Thread-1 (]: Began compiling node model.mini_project.month_revenue
[0m19:31:01.913711 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.month_revenue"
[0m19:31:01.915666 [debug] [Thread-1 (]: Began executing node model.mini_project.month_revenue
[0m19:31:01.920630 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.month_revenue"
[0m19:31:01.924422 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.month_revenue"
[0m19:31:01.925400 [debug] [Thread-1 (]: On model.mini_project.month_revenue: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.month_revenue"} */
create or replace transient table mini_project.intermediate_joins.month_revenue
         as
        (SELECT 
    customer_id,
    product_id,
    payment_month,
    SUM(revenue) AS total_revenue
FROM 
    mini_project.intermediate_joins.join
GROUP BY 
    customer_id, 
    product_id,
    payment_month
ORDER BY 
    customer_id, 
    product_id, 
    payment_month
        );
[0m19:31:02.711748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.795 seconds
[0m19:31:02.728295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E04410>]}
[0m19:31:02.728295 [info ] [Thread-1 (]: 5 of 14 OK created sql table model intermediate_joins.month_revenue ............ [[32mSUCCESS 1[0m in 0.83s]
[0m19:31:02.728295 [debug] [Thread-1 (]: Finished running node model.mini_project.month_revenue
[0m19:31:02.728295 [debug] [Thread-1 (]: Began running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m19:31:02.728295 [info ] [Thread-1 (]: 6 of 14 START sql table model mart.revenue_lost_due_to_contraction_kpi ......... [RUN]
[0m19:31:02.728295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.month_revenue, now model.mini_project.revenue_lost_due_to_contraction_kpi)
[0m19:31:02.744268 [debug] [Thread-1 (]: Began compiling node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m19:31:02.750034 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m19:31:02.764394 [debug] [Thread-1 (]: Began executing node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m19:31:02.770434 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m19:31:02.772305 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.revenue_lost_due_to_contraction_kpi"
[0m19:31:02.772305 [debug] [Thread-1 (]: On model.mini_project.revenue_lost_due_to_contraction_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.revenue_lost_due_to_contraction_kpi"} */
create or replace transient table mini_project.mart.revenue_lost_due_to_contraction_kpi
         as
        (WITH monthly_revenue AS (
    SELECT
        payment_month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate_joins.join
    GROUP BY
        PAYMENT_MONTH
)
SELECT
    PAYMENT_MONTH
    total_revenue,
    LAG(total_revenue) OVER (ORDER BY PAYMENT_MONTH) AS PREVIOUS_MONTH_REVENUE,
    CASE
        WHEN TOTAL_REVENUE<PREVIOUS_MONTH_REVENUE THEN ABS(PREVIOUS_MONTH_REVENUE-TOTAL_REVENUE)
        ELSE 0
    END AS REVENUE_LOST
FROM
    monthly_revenue
ORDER BY
    PAYMENT_MONTH
        );
[0m19:31:03.328274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m19:31:03.328274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15F3A960>]}
[0m19:31:03.338984 [info ] [Thread-1 (]: 6 of 14 OK created sql table model mart.revenue_lost_due_to_contraction_kpi .... [[32mSUCCESS 1[0m in 0.60s]
[0m19:31:03.338984 [debug] [Thread-1 (]: Finished running node model.mini_project.revenue_lost_due_to_contraction_kpi
[0m19:31:03.345461 [debug] [Thread-1 (]: Began running node model.mini_project.outer_join
[0m19:31:03.345461 [info ] [Thread-1 (]: 7 of 14 START sql table model intermediate_joins.outer_join .................... [RUN]
[0m19:31:03.345461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.revenue_lost_due_to_contraction_kpi, now model.mini_project.outer_join)
[0m19:31:03.350917 [debug] [Thread-1 (]: Began compiling node model.mini_project.outer_join
[0m19:31:03.357274 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.outer_join"
[0m19:31:03.360240 [debug] [Thread-1 (]: Began executing node model.mini_project.outer_join
[0m19:31:03.365566 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.outer_join"
[0m19:31:03.367532 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.outer_join"
[0m19:31:03.368566 [debug] [Thread-1 (]: On model.mini_project.outer_join: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.outer_join"} */
create or replace transient table mini_project.intermediate_joins.outer_join
         as
        (select
    j.CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    j.PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    j.PAYMENT_MONTH,
    REVENUE,
    REVENUE_TYPE,
    total_revenue,
    QUANTITY,
    COMPANIES
from 
mini_project.intermediate_joins.join as j 
inner join
mini_project.intermediate_joins.month_revenue as mr
on j.customer_id=mr.customer_id and j.product_id=mr.product_id AND j.payment_month=mr.payment_month
order by CUSTOMER_ID,PAYMENT_MONTH
        );
[0m19:31:04.212778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m19:31:04.217898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15F388F0>]}
[0m19:31:04.219904 [info ] [Thread-1 (]: 7 of 14 OK created sql table model intermediate_joins.outer_join ............... [[32mSUCCESS 1[0m in 0.87s]
[0m19:31:04.219904 [debug] [Thread-1 (]: Finished running node model.mini_project.outer_join
[0m19:31:04.219904 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_l3m
[0m19:31:04.219904 [info ] [Thread-1 (]: 8 of 14 START sql table model mart.kpi1_l3m .................................... [RUN]
[0m19:31:04.219904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.outer_join, now model.mini_project.kpi1_l3m)
[0m19:31:04.219904 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_l3m
[0m19:31:04.227904 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_l3m"
[0m19:31:04.229913 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_l3m
[0m19:31:04.232946 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_l3m"
[0m19:31:04.233948 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_l3m"
[0m19:31:04.233948 [debug] [Thread-1 (]: On model.mini_project.kpi1_l3m: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_l3m"} */
create or replace transient table mini_project.mart.kpi1_l3m
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-3,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m19:31:06.073188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m19:31:06.075188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15DF1BE0>]}
[0m19:31:06.076188 [info ] [Thread-1 (]: 8 of 14 OK created sql table model mart.kpi1_l3m ............................... [[32mSUCCESS 1[0m in 1.86s]
[0m19:31:06.077157 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_l3m
[0m19:31:06.077157 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_lm
[0m19:31:06.078155 [info ] [Thread-1 (]: 9 of 14 START sql table model mart.kpi1_lm ..................................... [RUN]
[0m19:31:06.079154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_l3m, now model.mini_project.kpi1_lm)
[0m19:31:06.079848 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_lm
[0m19:31:06.079848 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_lm"
[0m19:31:06.079848 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_lm
[0m19:31:06.079848 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_lm"
[0m19:31:06.079848 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_lm"
[0m19:31:06.079848 [debug] [Thread-1 (]: On model.mini_project.kpi1_lm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_lm"} */
create or replace transient table mini_project.mart.kpi1_lm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(month,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m19:31:07.950062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.872 seconds
[0m19:31:07.965924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15EED700>]}
[0m19:31:07.967933 [info ] [Thread-1 (]: 9 of 14 OK created sql table model mart.kpi1_lm ................................ [[32mSUCCESS 1[0m in 1.89s]
[0m19:31:07.967933 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_lm
[0m19:31:07.967933 [debug] [Thread-1 (]: Began running node model.mini_project.kpi1_ltm
[0m19:31:07.967933 [info ] [Thread-1 (]: 10 of 14 START sql table model mart.kpi1_ltm ................................... [RUN]
[0m19:31:07.967933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_lm, now model.mini_project.kpi1_ltm)
[0m19:31:07.967933 [debug] [Thread-1 (]: Began compiling node model.mini_project.kpi1_ltm
[0m19:31:07.975145 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.kpi1_ltm"
[0m19:31:07.975145 [debug] [Thread-1 (]: Began executing node model.mini_project.kpi1_ltm
[0m19:31:07.975145 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.kpi1_ltm"
[0m19:31:07.983014 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.kpi1_ltm"
[0m19:31:07.984601 [debug] [Thread-1 (]: On model.mini_project.kpi1_ltm: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.kpi1_ltm"} */
create or replace transient table mini_project.mart.kpi1_ltm
         as
        (WITH BASE AS (
    SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    COMPANY,
    PRODUCT_ID,
    PRODUCT_FAMILY,
    PRODUCT_SUB_FAMILY,
    PAYMENT_MONTH,
    DATEADD(year,-1,PAYMENT_MONTH) AS PREVIOUS_MONTH,
    REVENUE_TYPE,
    TOTAL_REVENUE,
    QUANTITY,
    COMPANIES
    FROM 
    mini_project.intermediate_joins.outer_join
),CTE AS(
    SELECT
    BASE.CUSTOMER_ID,
    BASE.CUSTOMER_NAME,
    BASE.COMPANY,
    BASE.PRODUCT_ID,
    BASE.PRODUCT_FAMILY,
    BASE.PRODUCT_SUB_FAMILY,
    BASE.PAYMENT_MONTH,
    BASE.PREVIOUS_MONTH,
    BASE.REVENUE_TYPE,
    BASE.TOTAL_REVENUE,
    BASE.QUANTITY,
    BASE.COMPANIES,
    OJ.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE
    FROM
    BASE LEFT JOIN mini_project.intermediate_joins.outer_join AS OJ on BASE.PREVIOUS_MONTH = OJ.PAYMENT_MONTH AND BASE.CUSTOMER_ID = OJ.CUSTOMER_ID 
),FINAL AS (
    SELECT 
*,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 'NEW_CUSTOMER'
    WHEN TOTAL_REVENUE = 0 THEN 'CHURNED_CUSTOMER'
    ELSE 'RETAINED_CUSTOMER'
END AS RETENTION,
CASE
    WHEN PREVIOUS_MONTH_REVENUE IS NULL THEN 0
    WHEN TOTAL_REVENUE = 0 THEN ABS(PREVIOUS_MONTH_REVENUE)
    ELSE 0
END AS CUSTOMER_CHURN_REVENUE
FROM 
cte
ORDER BY CUSTOMER_ID
)
SELECT 
*
FROM
FINAL
ORDER BY CUSTOMER_ID,PAYMENT_MONTH
        );
[0m19:31:09.127204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.142 seconds
[0m19:31:09.130204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E40500>]}
[0m19:31:09.131161 [info ] [Thread-1 (]: 10 of 14 OK created sql table model mart.kpi1_ltm .............................. [[32mSUCCESS 1[0m in 1.16s]
[0m19:31:09.132163 [debug] [Thread-1 (]: Finished running node model.mini_project.kpi1_ltm
[0m19:31:09.132928 [debug] [Thread-1 (]: Began running node model.mini_project.newlogos_kpi
[0m19:31:09.133469 [info ] [Thread-1 (]: 11 of 14 START sql table model mart.newlogos_kpi ............................... [RUN]
[0m19:31:09.134769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.kpi1_ltm, now model.mini_project.newlogos_kpi)
[0m19:31:09.134769 [debug] [Thread-1 (]: Began compiling node model.mini_project.newlogos_kpi
[0m19:31:09.138807 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.newlogos_kpi"
[0m19:31:09.139771 [debug] [Thread-1 (]: Began executing node model.mini_project.newlogos_kpi
[0m19:31:09.145045 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.newlogos_kpi"
[0m19:31:09.147045 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.newlogos_kpi"
[0m19:31:09.147849 [debug] [Thread-1 (]: On model.mini_project.newlogos_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.newlogos_kpi"} */
create or replace transient table mini_project.mart.newlogos_kpi
         as
        (WITH FIRST_PURCHASE AS (
    SELECT 
        CUSTOMER_ID,
        MIN(PAYMENT_MONTH) AS FIRST_PURCHASE
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID
)
SELECT
    YEAR(FIRST_PURCHASE) AS FISCAL_YEAR,
    COUNT(CUSTOMER_ID) AS NEW_CUSTOMERS
FROM FIRST_PURCHASE
GROUP BY FISCAL_YEAR
        );
[0m19:31:09.564481 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.418 seconds
[0m19:31:09.564481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E55FD0>]}
[0m19:31:09.564481 [info ] [Thread-1 (]: 11 of 14 OK created sql table model mart.newlogos_kpi .......................... [[32mSUCCESS 1[0m in 0.43s]
[0m19:31:09.564481 [debug] [Thread-1 (]: Finished running node model.mini_project.newlogos_kpi
[0m19:31:09.564481 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m19:31:09.572267 [info ] [Thread-1 (]: 12 of 14 START sql table model mart.ranking_customers_based_on_revenue_kpi ..... [RUN]
[0m19:31:09.572267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.newlogos_kpi, now model.mini_project.ranking_customers_based_on_revenue_kpi)
[0m19:31:09.572267 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m19:31:09.576910 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m19:31:09.576910 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m19:31:09.580926 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m19:31:09.582934 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_customers_based_on_revenue_kpi"
[0m19:31:09.582934 [debug] [Thread-1 (]: On model.mini_project.ranking_customers_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_customers_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_customers_based_on_revenue_kpi
         as
        (WITH CUSTOMER_REVENUE AS (
    SELECT
        CUSTOMER_ID,
        CUSTOMER_NAME,
        ROUND(SUM(TOTAL_REVENUE),3) AS TOTAL_REVENUE_BY_CUSTOMER
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY CUSTOMER_ID,CUSTOMER_NAME
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_CUSTOMER DESC) AS RANK
FROM 
CUSTOMER_REVENUE
        );
[0m19:31:10.042635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.461 seconds
[0m19:31:10.042635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E56CC0>]}
[0m19:31:10.042635 [info ] [Thread-1 (]: 12 of 14 OK created sql table model mart.ranking_customers_based_on_revenue_kpi  [[32mSUCCESS 1[0m in 0.47s]
[0m19:31:10.042635 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_customers_based_on_revenue_kpi
[0m19:31:10.042635 [debug] [Thread-1 (]: Began running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m19:31:10.042635 [info ] [Thread-1 (]: 13 of 14 START sql table model mart.ranking_products_based_on_revenue_kpi ...... [RUN]
[0m19:31:10.042635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_customers_based_on_revenue_kpi, now model.mini_project.ranking_products_based_on_revenue_kpi)
[0m19:31:10.042635 [debug] [Thread-1 (]: Began compiling node model.mini_project.ranking_products_based_on_revenue_kpi
[0m19:31:10.059706 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m19:31:10.061065 [debug] [Thread-1 (]: Began executing node model.mini_project.ranking_products_based_on_revenue_kpi
[0m19:31:10.063864 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m19:31:10.065827 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.ranking_products_based_on_revenue_kpi"
[0m19:31:10.066830 [debug] [Thread-1 (]: On model.mini_project.ranking_products_based_on_revenue_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.ranking_products_based_on_revenue_kpi"} */
create or replace transient table mini_project.mart.ranking_products_based_on_revenue_kpi
         as
        (WITH PRODUCT_REVENUE AS (
    SELECT
        PRODUCT_ID,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE_BY_PRODUCT
    FROM
    mini_project.intermediate_joins.outer_join
    GROUP BY PRODUCT_ID
)
SELECT 
    *,
    RANK() OVER( ORDER BY TOTAL_REVENUE_BY_PRODUCT DESC) AS RANK
FROM 
PRODUCT_REVENUE
        );
[0m19:31:10.547620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m19:31:10.547620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15E57500>]}
[0m19:31:10.547620 [info ] [Thread-1 (]: 13 of 14 OK created sql table model mart.ranking_products_based_on_revenue_kpi . [[32mSUCCESS 1[0m in 0.50s]
[0m19:31:10.547620 [debug] [Thread-1 (]: Finished running node model.mini_project.ranking_products_based_on_revenue_kpi
[0m19:31:10.547620 [debug] [Thread-1 (]: Began running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m19:31:10.547620 [info ] [Thread-1 (]: 14 of 14 START sql table model mart.highest_cross_sell_and_product_churn_kpi ... [RUN]
[0m19:31:10.556591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.mini_project.ranking_products_based_on_revenue_kpi, now model.mini_project.highest_cross_sell_and_product_churn_kpi)
[0m19:31:10.557599 [debug] [Thread-1 (]: Began compiling node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m19:31:10.561653 [debug] [Thread-1 (]: Writing injected SQL for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m19:31:10.563662 [debug] [Thread-1 (]: Began executing node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m19:31:10.566680 [debug] [Thread-1 (]: Writing runtime sql for node "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m19:31:10.570693 [debug] [Thread-1 (]: Using snowflake connection "model.mini_project.highest_cross_sell_and_product_churn_kpi"
[0m19:31:10.570693 [debug] [Thread-1 (]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "mini_project", "target_name": "dev", "node_id": "model.mini_project.highest_cross_sell_and_product_churn_kpi"} */
create or replace transient table mini_project.mart.highest_cross_sell_and_product_churn_kpi
         as
        (WITH BASE AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        CUSTOMER_NAME,
        DATEADD(month,-3,PAYMENT_MONTH) AS PREVIOUS_MONTH,
        COUNT(DISTINCT PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        CUSTOMER_NAME
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH,CUSTOMER_NAME
),BASE2 AS (
    SELECT 
        CUSTOMER_ID,
        PAYMENT_MONTH,
        COUNT(PRODUCT_ID) AS NO_OF_PRODUCTS,
        SUM(TOTAL_REVENUE) AS TOTAL_REVENUE
    FROM mini_project.mart.kpi1_lm
    GROUP BY 
        CUSTOMER_ID,
        PAYMENT_MONTH
),max_payment_month as (
    select
    max(payment_month) as max_payment_month
    from mini_project.mart.kpi1_lm
),
product_churn AS (
    SELECT
        LM.CUSTOMER_NAME,
        COUNT(DISTINCT CASE WHEN PAYMENT_MONTH < DATEADD(MONTH,-3,max_payment_month) THEN PRODUCT_ID END) AS Product_Churn
    FROM
        mini_project.mart.kpi1_lm AS LM join max_payment_month ON 1=1
    GROUP BY
        LM.CUSTOMER_NAME
),
 FINAL AS (
    SELECT 
        BASE.CUSTOMER_NAME,
        BASE.CUSTOMER_ID,
        BASE.PAYMENT_MONTH,
        BASE.NO_OF_PRODUCTS,
        BASE.TOTAL_REVENUE,
        BASE.PREVIOUS_MONTH,
        BASE2.TOTAL_REVENUE AS PREVIOUS_MONTH_REVENUE,
        BASE2.NO_OF_PRODUCTS AS NO_OF_PRODUCTS_PAST_MONTH,
        Product_Churn
    FROM BASE LEFT JOIN BASE2 ON BASE.CUSTOMER_ID=BASE2.CUSTOMER_ID AND BASE.PREVIOUS_MONTH=BASE2.PAYMENT_MONTH LEFT JOIN PRODUCT_CHURN ON BASE.CUSTOMER_NAME=PRODUCT_CHURN.CUSTOMER_NAME
    ORDER BY CUSTOMER_ID,PAYMENT_MONTH
),FINAL2 AS (
SELECT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    PAYMENT_MONTH,
    NO_OF_PRODUCTS,
    TOTAL_REVENUE,
    PREVIOUS_MONTH,
    PREVIOUS_MONTH_REVENUE,
    NO_OF_PRODUCTS_PAST_MONTH,
    CASE
        WHEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))>0 THEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))
        ELSE 0
    END AS CROSS_SELL_IN_PRODUCTS,
    CASE
        WHEN (NO_OF_PRODUCTS-(NO_OF_PRODUCTS_PAST_MONTH-Product_Churn))>0 THEN (TOTAL_REVENUE-PREVIOUS_MONTH_REVENUE) 
        ELSE 0 
    END AS CROSS_SELL_IN_REVENUE,
    Product_Churn AS PRODUCT_CHURN
FROM 
FINAL
),FINAL3 AS (
    SELECT
    *,
    RANK() OVER(ORDER BY CROSS_SELL_IN_REVENUE DESC) AS CROSS_SELL_RANK,
    RANK() OVER(ORDER BY PRODUCT_CHURN DESC) AS PRODUCT_CHURN_RANK 
    FROM FINAL2
)
SELECT
*
FROM
FINAL3
ORDER BY CROSS_SELL_RANK,PRODUCT_CHURN_RANK
        );
[0m19:31:11.434771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.868 seconds
[0m19:31:11.434771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '795cc55e-6725-47cc-8e28-3f57416f191e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15DF12E0>]}
[0m19:31:11.434771 [info ] [Thread-1 (]: 14 of 14 OK created sql table model mart.highest_cross_sell_and_product_churn_kpi  [[32mSUCCESS 1[0m in 0.88s]
[0m19:31:11.434771 [debug] [Thread-1 (]: Finished running node model.mini_project.highest_cross_sell_and_product_churn_kpi
[0m19:31:11.434771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:11.434771 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:31:11.434771 [debug] [MainThread]: On list_mini_project: Close
[0m19:31:11.534668 [debug] [MainThread]: Connection 'list_mini_project_mart' was left open.
[0m19:31:11.550327 [debug] [MainThread]: On list_mini_project_mart: Close
[0m19:31:11.663257 [debug] [MainThread]: Connection 'model.mini_project.highest_cross_sell_and_product_churn_kpi' was left open.
[0m19:31:11.663257 [debug] [MainThread]: On model.mini_project.highest_cross_sell_and_product_churn_kpi: Close
[0m19:31:11.796088 [info ] [MainThread]: 
[0m19:31:11.796088 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 18.88 seconds (18.88s).
[0m19:31:11.796088 [debug] [MainThread]: Command end result
[0m19:31:11.833821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\AdithyaKasturi\mini_project\target\manifest.json
[0m19:31:11.838530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\AdithyaKasturi\mini_project\target\semantic_manifest.json
[0m19:31:11.845809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\AdithyaKasturi\mini_project\target\run_results.json
[0m19:31:11.845809 [info ] [MainThread]: 
[0m19:31:11.845809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:11.845809 [info ] [MainThread]: 
[0m19:31:11.845809 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:31:11.852189 [debug] [MainThread]: Command `dbt run` succeeded at 19:31:11.852189 after 24.71 seconds
[0m19:31:11.853200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D12F432F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D1305BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D15568B60>]}
[0m19:31:11.853819 [debug] [MainThread]: Flushing usage events
[0m19:31:13.739503 [debug] [MainThread]: An error was encountered while trying to flush usage events
